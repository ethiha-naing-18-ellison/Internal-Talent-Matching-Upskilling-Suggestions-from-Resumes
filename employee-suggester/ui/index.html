<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Primary SEO -->
    <title>Employee Suggester v1.3.0.0</title>
    <meta name="description" content="Paste a resume and instantly get suggested roles with matched & missing skills. Supports PDF/DOCX/TXT. Open-source MVP.">
    <link rel="canonical" href="http://127.0.0.1:8080/">

    <!-- Basic Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="index,follow">
    <meta name="theme-color" content="#0ea5e9">
    <meta name="color-scheme" content="light dark">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Employee Suggester – Match Your Resume to Roles">
    <meta property="og:description" content="Paste a resume and get role suggestions with skill gaps.">
    <meta property="og:url" content="http://127.0.0.1:8080/">
    <meta property="og:image" content="http://127.0.0.1:8080/og-image.png">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Employee Suggester – Match Your Resume to Roles">
    <meta name="twitter:description" content="Instant role suggestions from your resume.">
    <meta name="twitter:image" content="http://127.0.0.1:8080/og-image.png">

    <!-- PWA / Icons (optional, but nice) -->
    <link rel="icon" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">

    <!-- Performance hints (optional) -->
    <link rel="preconnect" href="http://127.0.0.1:8002" crossorigin>
    
    <!-- API Configuration -->
    <meta name="api-base" content="">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context":"https://schema.org",
      "@type":"SoftwareApplication",
      "name":"Employee Suggester",
      "applicationCategory":"BusinessApplication",
      "operatingSystem":"Web",
      "description":"Paste a resume and get suggested roles with matched & missing skills.",
      "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},
      "creator":{"@type":"Organization","name":"Employee Suggester"}
    }
    </script>
    
    <style>
        :root {
            --bg: #0f172a;
            --text: #f1f5f9;
            --muted: #94a3b8;
            --primary: #0ea5e9;
            --border: #334155;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --bg-light: #1e293b;
            --bg-white: #1e293b;
            --text-dark: #f1f5f9;
            --text-gray: #cbd5e1;
            --text-light: #94a3b8;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.4);
            --radius: 12px;
            --radius-lg: 16px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--bg) 0%, #1e293b 100%);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInDown 0.8s ease-out;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .logo-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            box-shadow: var(--shadow-lg);
        }

        .main-title {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--text-gray);
            font-weight: 400;
        }

        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .card {
            background: var(--bg-light);
            border-radius: var(--radius-lg);
            padding: 2rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .upload-icon {
            background: linear-gradient(135deg, var(--accent), var(--primary));
        }

        .text-icon {
            background: linear-gradient(135deg, var(--success), var(--primary));
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        /* File Upload */
        .file-upload-area {
            border: 2px dashed var(--border);
            border-radius: var(--radius);
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 1rem;
        }

        .file-upload-area:hover {
            border-color: var(--primary);
            background: rgba(102, 126, 234, 0.05);
        }

        .file-upload-area.dragover {
            border-color: var(--primary);
            background: rgba(102, 126, 234, 0.1);
        }

        .upload-icon-large {
            font-size: 3rem;
            color: var(--text-light);
            margin-bottom: 1rem;
        }

        .upload-text {
            color: var(--text-gray);
            margin-bottom: 0.5rem;
        }

        .upload-hint {
            font-size: 0.875rem;
            color: var(--text-light);
        }

        #file {
            display: none;
        }

        /* Textarea */
        .textarea-container {
            position: relative;
        }

        #resume {
            width: 100%;
            height: 200px;
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            font-family: 'Inter', sans-serif;
            font-size: 0.875rem;
            resize: vertical;
            transition: border-color 0.3s ease;
            background: var(--bg);
            color: var(--text);
        }

        #resume:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        /* Controls */
        .controls {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .input-group label {
            font-weight: 500;
            color: var(--text-gray);
            white-space: nowrap;
        }

        #k {
            width: 70px;
            padding: 0.5rem;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            font-family: 'Inter', sans-serif;
            text-align: center;
            background: var(--bg);
            color: var(--text);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--radius);
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            white-space: nowrap;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            box-shadow: var(--shadow);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn-success {
            background: var(--success);
            color: white;
            box-shadow: var(--shadow);
        }

        .btn-success:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .loading {
            position: relative;
            overflow: hidden;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Results Section */
        .results-section {
            margin-top: 2rem;
            animation: fadeInUp 0.8s ease-out;
        }

        .results-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .results-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--success), var(--primary));
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        .results-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .results-count {
            background: var(--accent);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        /* Table */
        .table-container {
            background: var(--bg-light);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            vertical-align: top;
        }

        .table tbody tr:hover {
            background: rgba(14, 165, 233, 0.1);
        }

        .table tbody tr:last-child td {
            border-bottom: none;
        }

        .role-title {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.25rem;
        }

        .role-id {
            font-size: 0.75rem;
            color: var(--text-light);
        }

        .score {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.375rem 0.75rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .score-excellent { background: #d6f5d6; color: #22543d; }
        .score-good { background: #bee3f8; color: #2c5282; }
        .score-fair { background: #fef5e7; color: #c05621; }
        .score-poor { background: #fed7d7; color: #c53030; }

        .skills {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .skill-tag {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .skill-matched {
            background: #d6f5d6;
            color: #22543d;
        }

        .skill-missing {
            background: #fed7d7;
            color: #c53030;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--text-light);
            background: var(--bg-light);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .main-content {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .main-title {
                font-size: 2rem;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }

            .table-container {
                overflow-x: auto;
            }

            .skills {
                flex-direction: column;
                gap: 0.25rem;
            }
        }

        /* Animations */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeInUp 0.6s ease-out;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: var(--radius);
            color: white;
            font-weight: 500;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: var(--success);
        }

        .notification.error {
            background: var(--error);
        }

        /* New Design System Styles */
        .skip-link{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
        .skip-link:focus{left:12px;top:12px;width:auto;height:auto;padding:8px 12px;background:#000;color:#fff;border-radius:8px}
        .site-header{position:sticky;top:0;background:var(--bg-light);border-bottom:1px solid var(--border);z-index:10}
        .site-header .container{display:flex;align-items:center;gap:16px;height:80px}
        .brand{display:flex;align-items:center;gap:15px;font-weight:700;padding:8px 12px;border-radius:12px;background:linear-gradient(135deg,rgba(59,130,246,0.1),rgba(147,51,234,0.1));border:1px solid rgba(59,130,246,0.2)}
        .logo-img{width:60px;height:60px;border-radius:12px;object-fit:contain;box-shadow:0 2px 8px rgba(0,0,0,0.1);transition:all 0.3s ease;cursor:pointer}
        .logo-img:hover{transform:scale(1.1);box-shadow:0 4px 16px rgba(0,0,0,0.2)}
        .brand-name{color:inherit;text-decoration:none}
        .nav{display:flex;gap:16px;margin-left:auto}
        .nav a{color:var(--text);text-decoration:none}
        .actions{display:flex;gap:8px}
        .hero{padding:40px 0;border-bottom:1px solid var(--border)}
        .hero h1{margin:0 0 8px;font-size:28px}
        .hero p{margin:0 0 12px;color:var(--muted)}
        .cta-row{display:flex;gap:10px;margin:8px 0 4px}
        
        /* Header and Hero Button Styles */
        .actions .btn, .cta-row .btn {
            padding:10px 14px;
            border-radius:10px;
            border:1px solid var(--border);
            background:var(--bg-light);
            color: var(--text);
            cursor:pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            font-size: 0.875rem;
        }
        .actions .btn-primary, .cta-row .btn-primary {
            background:var(--primary);
            color:#fff;
            border-color:var(--primary);
        }
        .actions .btn-secondary, .cta-row .btn-secondary {
            background:#111;
            color:#fff;
            border-color:#111;
        }
        .actions .btn-ghost, .cta-row .btn-ghost {
            background:transparent;
        }

        .site-footer{margin-top:40px;padding:28px 0;border-top:1px solid var(--border);background:var(--bg)}
        .footer-grid{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:20px}
        .footer-grid h4{margin:.2rem 0 .4rem}
        .footer-grid ul{list-style:none;padding:0;margin:0}
        .footer-grid li{margin:.3rem 0}
        .tiny{font-size:0.75rem;color:var(--muted);margin-top:0.5rem}
        
        /* Footer logo styling */
        .site-footer .brand{background:linear-gradient(135deg,rgba(59,130,246,0.15),rgba(147,51,234,0.15));padding:12px 16px;border-radius:16px;border:2px solid rgba(59,130,246,0.3);margin-bottom:1rem}
        .site-footer .logo-img{width:50px;height:50px;border-radius:10px;object-fit:contain;box-shadow:0 3px 12px rgba(0,0,0,0.15)}
        
        /* Informational Sections Styling */
        .info-section {
            margin: 3rem 0;
            padding: 2rem;
            background: var(--bg-light);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }
        
        .info-section h2 {
            color: var(--text-dark);
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .info-section h2::before {
            content: '';
            width: 4px;
            height: 2rem;
            background: linear-gradient(135deg, var(--primary), var(--success));
            border-radius: 2px;
        }
        
        /* How it works section */
        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }
        
        .step-card {
            background: linear-gradient(135deg, #1e293b, #334155);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .step-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 3rem;
            height: 3rem;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }
        
        .step-card h3 {
            color: var(--text-dark);
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .step-card p {
            color: var(--text-gray);
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        /* Features section */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }
        
        .feature-card {
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .feature-icon {
            width: 3rem;
            height: 3rem;
            background: linear-gradient(135deg, var(--primary), var(--success));
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }
        
        .feature-card h3 {
            color: var(--text-dark);
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .feature-card p {
            color: var(--text-gray);
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        /* Dataset section */
        .dataset-info {
            background: linear-gradient(135deg, #0c4a6e, #075985);
            border: 1px solid #0ea5e9;
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-top: 1rem;
        }
        
        .dataset-info p {
            color: var(--text-dark);
            margin-bottom: 1rem;
        }
        
        .dataset-info code {
            background: #1e293b;
            color: #f1f5f9;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
        }
        
        .file-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .file-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--primary);
            color: white;
            text-decoration: none;
            border-radius: var(--radius);
            font-size: 0.875rem;
            font-weight: 500;
            transition: background 0.3s ease;
        }
        
        .file-link:hover {
            background: #0284c7;
        }
        
        /* API section */
        .api-endpoints {
            margin-top: 1rem;
        }
        
        .endpoint {
            background: #1e293b;
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
            color: #f1f5f9;
        }
        
        .endpoint-method {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            margin-right: 0.75rem;
        }
        
        .method-post {
            background: #dc2626;
            color: white;
        }
        
        .method-get {
            background: #16a34a;
            color: white;
        }
        
        .endpoint-path {
            font-family: 'Courier New', monospace;
            font-weight: 600;
            color: #60a5fa;
        }
        
        .endpoint-description {
            margin-top: 0.5rem;
            color: #cbd5e1;
            font-size: 0.9rem;
        }
        
        .docs-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: var(--success);
            color: white;
            text-decoration: none;
            border-radius: var(--radius);
            font-weight: 500;
            margin-top: 1rem;
            transition: background 0.3s ease;
        }
        
        .docs-link:hover {
            background: #15803d;
        }
        
        /* FAQ section */
        .faq-list {
            margin-top: 1rem;
        }
        
        .faq-item {
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            margin-bottom: 0.75rem;
            overflow: hidden;
        }
        
        .faq-item details {
            cursor: pointer;
        }
        
        .faq-item summary {
            padding: 1rem 1.5rem;
            background: linear-gradient(135deg, #1e293b, #334155);
            font-weight: 600;
            color: var(--text);
            border-bottom: 1px solid var(--border);
            list-style: none;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .faq-item summary::-webkit-details-marker {
            display: none;
        }
        
        .faq-item summary::after {
            content: '+';
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
            transition: transform 0.3s ease;
        }
        
        .faq-item[open] summary::after {
            transform: rotate(45deg);
        }
        
        .faq-answer {
            padding: 1rem 1.5rem;
            color: var(--text-gray);
            line-height: 1.6;
            background: var(--bg-light);
        }
        
        @media (max-width:900px){ 
            .nav{display:none} 
            .footer-grid{grid-template-columns:1fr 1fr}
            .steps-grid, .features-grid {
                grid-template-columns: 1fr;
            }
            .file-links {
                flex-direction: column;
            }
        }
                 @media (prefers-reduced-motion: reduce){ *{scroll-behavior:auto} }
         
         /* Analysis Card Dropdown Styles */
         .analysis-card details[open] summary .fa-chevron-down {
             transform: rotate(180deg);
         }
         
         .analysis-card summary::-webkit-details-marker {
             display: none;
         }
         
         .analysis-card details[open] summary div:last-child {
             transform: rotate(180deg);
         }
         
         .analysis-card summary div:last-child {
             transition: transform 0.3s ease;
         }
     </style>
</head>
<body>
    <a class="skip-link" href="#main">Skip to content</a>

    <header class="site-header">
        <div class="container">
            <div class="brand">
                <img src="../images/logo/TN LOGO.png" alt="Employee Suggester Logo" class="logo-img">
                <a href="/" class="brand-name">Employee Suggester</a>
            </div>
            <nav class="nav" aria-label="Primary">
                <a href="#how">How it works</a>
                <a href="#features">Features</a>
                <a href="#dataset">Jobs & Skills</a>
                <a href="#api">API</a>
                <a href="#faq">FAQ</a>
            </nav>
            <div class="actions">
                <button class="btn btn-primary" onclick="document.getElementById('file').click()">Upload resume</button>
                <button class="btn btn-ghost" onclick="fillSample()">Use sample</button>
                <button class="btn btn-ghost" onclick="setApiBase()">Set API URL</button>
            </div>
        </div>
    </header>

    <section class="hero">
        <div class="container">
            <h1>Match your resume to real roles</h1>
            <p>Paste your resume or upload a file. We'll suggest roles and show matched & missing skills.</p>
            <div class="cta-row">
                <button class="btn btn-primary" onclick="ingest()">Extract text from file</button>
                <button class="btn btn-secondary" onclick="suggest()">Suggest roles</button>
                <a class="btn btn-ghost" href="#api">View API</a>
            </div>
            <small>Supports PDF/DOCX/TXT • Local processing via your API</small>
        </div>
    </section>

    <main id="main" class="container" style="margin:28px auto">

        <!-- Main Content -->
        <div class="main-content">
            <!-- File Upload Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon upload-icon">
                        <i class="fas fa-upload"></i>
                    </div>
                    <h2 class="card-title">Upload Resume</h2>
                </div>
                <div class="file-upload-area" onclick="document.getElementById('file').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon-large"></i>
                    <div class="upload-text">Drag & drop your resume here or click to browse</div>
                    <div class="upload-hint">Supports PDF, DOCX, and TXT files</div>
                </div>
                <input id="file" type="file" accept=".pdf,.docx,.doc,.txt" />
                <button class="btn btn-primary" onclick="ingest()">
                    <i class="fas fa-file-text"></i>
                    Extract Text from File
                </button>
            </div>

            <!-- Text Input Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon text-icon">
                        <i class="fas fa-edit"></i>
                    </div>
                    <h2 class="card-title">Resume Text</h2>
                </div>
                <div class="textarea-container">
                    <textarea id="resume" placeholder="Paste your resume text here or upload a file to auto-fill..."></textarea>
                </div>
                            <div class="controls">
                <div class="input-group">
                    <label for="k">Show top</label>
                    <input id="k" type="number" value="5" min="1" max="20">
                    <span>matches</span>
                </div>
                <div class="input-group">
                    <span style="color: var(--muted); font-size: 0.875rem;">v1.3.0.0</span>
                </div>
                <button class="btn btn-success" onclick="suggest()">
                    <i class="fas fa-search"></i>
                    Find Matching Roles
                </button>
            </div>
            </div>
        </div>

        <!-- Results Section -->
        <div id="results" class="results-section" style="display: none;">
            <div class="results-header">
                <div class="results-icon">
                    <i class="fas fa-bullseye"></i>
                </div>
                <h2 class="results-title">Career Matches</h2>
                <span id="results-count" class="results-count">0 results</span>
            </div>
            
            <!-- Enhanced Results Tabs -->
            <div id="enhanced-tabs" style="display: none; margin-bottom: 1.5rem;">
                                 <div style="display: flex; gap: 0.5rem; background: var(--bg); border-radius: var(--radius); padding: 0.25rem; margin-bottom: 1rem;">
                     <button class="tab-btn active" onclick="showTab('matches')" style="padding: 0.5rem 1rem; border: none; border-radius: var(--radius); background: transparent; color: var(--muted); cursor: pointer; transition: all 0.3s ease;">Job Matches</button>
                     <button class="tab-btn" onclick="showTab('profile')" style="padding: 0.5rem 1rem; border: none; border-radius: var(--radius); background: transparent; color: var(--muted); cursor: pointer; transition: all 0.3s ease;">Profile</button>
                     <button class="tab-btn" onclick="showTab('upskill')" style="padding: 0.5rem 1rem; border: none; border-radius: var(--radius); background: transparent; color: var(--muted); cursor: pointer; transition: all 0.3s ease;">Upskilling</button>
                 </div>
                
                                 <!-- Matches Tab -->
                 <div id="matches-tab" class="tab-content active" style="display: block;">
                     <!-- Job Matching Table moved to top -->
                     <div class="table-container" style="margin-bottom: 2rem;">
                         <table class="table">
                             <thead>
                                 <tr>
                                     <th><i class="fas fa-briefcase"></i> Role</th>
                                     <th><i class="fas fa-star"></i> Match Score</th>
                                     <th><i class="fas fa-check-circle"></i> Your Skills</th>
                                     <th><i class="fas fa-exclamation-circle"></i> Skills to Learn</th>
                                 </tr>
                             </thead>
                             <tbody id="results-body">
                             </tbody>
                         </table>
                     </div>
                     
                     <!-- Enhanced Analysis Cards -->
                     <div id="matches-content"></div>
                 </div>
                 
                 <!-- Profile Tab -->
                 <div id="profile-tab" class="tab-content" style="display: none;">
                     <div id="profile-content"></div>
                 </div>
                </div>
                
                <!-- Upskilling Tab -->
                <div id="upskill-tab" class="tab-content" style="display: none;">
                    <!-- Role Selection Section -->
                    <div id="role-selection-section" style="display: none; margin-bottom: 2rem;">
                        <div class="card" style="background: linear-gradient(135deg, rgba(14, 165, 233, 0.1), rgba(16, 185, 129, 0.1)); border: 1px solid var(--primary);">
                            <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                <div style="width: 40px; height: 40px; background: linear-gradient(135deg, var(--primary), #0284c7); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                    <i class="fas fa-bullseye" style="color: white; font-size: 1.1rem;"></i>
                                </div>
                                <div>
                                    <h3 style="margin: 0; color: var(--text); font-size: 1.1rem; font-weight: 600;">Target Role Selection</h3>
                                    <p style="margin: 0.25rem 0 0 0; color: var(--text-light); font-size: 0.875rem;">Choose your target role for personalized upskilling recommendations</p>
                                </div>
                            </div>
                            
                            <div style="display: flex; align-items: center; gap: 1rem; flex-wrap: wrap;">
                                <div style="flex: 1; min-width: 200px;">
                                    <label for="target-role-select" style="display: block; margin-bottom: 0.5rem; color: var(--text); font-weight: 500;">Select Target Role:</label>
                                    <select id="target-role-select" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: var(--radius); background: var(--bg); color: var(--text); font-size: 0.875rem;">
                                        <option value="">Loading roles...</option>
                                    </select>
                                </div>
                                <button id="generate-upskilling-btn" onclick="generateUpskillingForSelectedRole()" style="padding: 0.75rem 1.5rem; background: var(--primary); color: white; border: none; border-radius: var(--radius); cursor: pointer; font-weight: 500; transition: all 0.3s ease;">
                                    <i class="fas fa-rocket"></i>
                                    Generate Upskilling Plan
                                </button>
                            </div>
                            
                            <div style="margin-top: 1rem; padding: 1rem; background: var(--bg); border-radius: var(--radius); border-left: 4px solid var(--primary);">
                                <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                                    <i class="fas fa-info-circle" style="color: var(--primary); margin-top: 0.125rem;"></i>
                                    <div>
                                        <strong style="color: var(--text);">How it works:</strong>
                                        <ul style="margin: 0.5rem 0 0 0; padding-left: 1.25rem; color: var(--text-light); font-size: 0.875rem;">
                                            <li>Select a role from your job matches to get targeted upskilling recommendations</li>
                                            <li>Get personalized courses, projects, and skills tailored to your chosen role</li>
                                            <li>Focus on the most important skills for your target career path</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="upskill-content"></div>
                </div>
            </div>
            
            <!-- Basic Results Table - Removed, now in Job Matches tab -->
            <div id="basic-results" style="display: none;">
                <!-- Job matching table moved to Job Matches tab -->
            </div>
        </div>

        <!-- Empty State -->
        <div id="empty-state" class="empty-state">
            <i class="fas fa-search empty-icon"></i>
            <h3>Ready to find your perfect role?</h3>
            <p>Upload your resume or paste your text above to get started with AI-powered career recommendations.</p>
        </div>

        <!-- Informational Sections -->
        <section id="how" class="info-section">
            <h2><i class="fas fa-cogs"></i> How it works</h2>
            <div class="steps-grid">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h3>Upload Resume</h3>
                    <p>Upload or paste your resume in PDF, DOCX, or TXT format.</p>
                </div>
                <div class="step-card">
                    <div class="step-number">2</div>
                    <h3>Extract & Embed</h3>
                    <p>We extract skills and embed your text using advanced NLP.</p>
                </div>
                <div class="step-card">
                    <div class="step-number">3</div>
                    <h3>Match Roles</h3>
                    <p>We retrieve similar roles, then re-score by skill overlap.</p>
                </div>
                <div class="step-card">
                    <div class="step-number">4</div>
                    <h3>Analyze Gaps</h3>
                    <p>See matched vs missing skills; act on gaps to improve.</p>
                </div>
            </div>
        </section>

        <section id="features" class="info-section">
            <h2><i class="fas fa-star"></i> Features</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-file-upload"></i>
                    </div>
                    <h3>Multi-format Support</h3>
                    <p>Upload and process PDF, DOCX, and TXT files with intelligent text extraction.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-crosshairs"></i>
                    </div>
                    <h3>Skill Matching</h3>
                    <p>See exactly which skills you have and which ones are missing for each role.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-rocket"></i>
                    </div>
                    <h3>Fast Local API</h3>
                    <p>Lightning-fast processing with FastAPI backend and FAISS vector search.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-database"></i>
                    </div>
                    <h3>Extensible Data</h3>
                    <p>Easily customize jobs and skills taxonomy to match your industry needs.</p>
                </div>
            </div>
        </section>

        <section id="dataset" class="info-section">
            <h2><i class="fas fa-chart-line"></i> Jobs & Skills Taxonomy</h2>
            <div class="dataset-info">
                <p>Our system is built on comprehensive, editable datasets that you can customize for your specific needs:</p>
                <p><strong>Jobs Database:</strong> <code>data/jobs/jobs.jsonl</code> - Contains detailed job descriptions and requirements</p>
                <p><strong>Skills Taxonomy:</strong> <code>data/taxonomy/skills.csv</code> - Comprehensive list of technical and soft skills</p>
                <div class="file-links">
                    <a href="../data/jobs/jobs.jsonl" download="jobs.jsonl" class="file-link">
                        <i class="fas fa-download"></i> Download Jobs Data
                    </a>
                    <a href="../data/taxonomy/skills.csv" download="skills.csv" class="file-link">
                        <i class="fas fa-download"></i> Download Skills Data
                    </a>
                </div>
            </div>
        </section>

        <section id="api" class="info-section">
            <h2><i class="fas fa-code"></i> API Reference</h2>
            <div class="api-endpoints">
                <div class="endpoint">
                    <div>
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/ingest_resume</span>
                    </div>
                    <div class="endpoint-description">
                        Upload a resume file (multipart/form-data) and extract text content. Returns parsed text ready for analysis.
                    </div>
                </div>
                <div class="endpoint">
                    <div>
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/suggest/roles?resume_text=...&topk=5</span>
                    </div>
                    <div class="endpoint-description">
                        Get ranked job role suggestions based on resume text. Returns matched/missing skills for each role.
                    </div>
                </div>
                <a href="http://127.0.0.1:8001/docs" target="_blank" rel="noopener" class="docs-link">
                    <i class="fas fa-external-link-alt"></i> Open Interactive API Documentation
                </a>
            </div>
        </section>

        <section id="faq" class="info-section">
            <h2><i class="fas fa-question-circle"></i> Frequently Asked Questions</h2>
            <div class="faq-list">
                <div class="faq-item">
                    <details>
                        <summary>What file formats are supported?</summary>
                        <div class="faq-answer">
                            Our system supports PDF, DOCX (Microsoft Word), and TXT (plain text) files. We use advanced document parsing to extract text content while preserving formatting and structure where possible.
                        </div>
                    </details>
                </div>
                <div class="faq-item">
                    <details>
                        <summary>Is my resume data secure and private?</summary>
                        <div class="faq-answer">
                            Absolutely! In this MVP version, all processing happens locally against your own API server. Your resume data never leaves your system or gets uploaded to any third-party service. Everything runs on your local machine.
                        </div>
                    </details>
                </div>
                <div class="faq-item">
                    <details>
                        <summary>How accurate are the role suggestions?</summary>
                        <div class="faq-answer">
                            Our matching algorithm uses advanced NLP and vector similarity search to find relevant roles. The accuracy depends on the quality of your resume content and our job database. We recommend providing detailed skill and experience information for best results.
                        </div>
                    </details>
                </div>
                <div class="faq-item">
                    <details>
                        <summary>Can I customize the job database?</summary>
                        <div class="faq-answer">
                            Yes! The system is designed to be extensible. You can edit the <code>data/jobs/jobs.jsonl</code> file to add your own job descriptions and the <code>data/taxonomy/skills.csv</code> file to customize the skills taxonomy to match your industry or organization.
                        </div>
                    </details>
                </div>
            </div>
        </section>
    </main>

    <script>
        const META_API = document.querySelector('meta[name="api-base"]')?.content?.trim();
        const STORED_API = localStorage.getItem('API_BASE');
        const DEFAULT_API = "http://127.0.0.1:8002";
        window.API_BASE = STORED_API || META_API || DEFAULT_API;
        const API = window.API_BASE;

        // tiny UI to set API at runtime (optional)
        function setApiBase(){
          const url = prompt("API base URL:", API);
          if (!url) return;
          localStorage.setItem('API_BASE', url);
          alert("Saved. Reloading...");
          location.reload();
        }

        // File drag & drop functionality
        const fileUploadArea = document.querySelector('.file-upload-area');
        const fileInput = document.getElementById('file');

        fileUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUploadArea.classList.add('dragover');
        });

        fileUploadArea.addEventListener('dragleave', () => {
            fileUploadArea.classList.remove('dragover');
        });

        fileUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                fileInput.files = files;
                ingest();
            }
        });

        fileInput.addEventListener('change', () => {
            if (fileInput.files.length > 0) {
                ingest();
            }
        });

        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 3000);
        }

        // Set button loading state
        function setButtonLoading(button, loading) {
            if (loading) {
                button.disabled = true;
                button.classList.add('loading');
                const icon = button.querySelector('i');
                const originalIcon = icon.className;
                icon.className = 'fas fa-spinner fa-spin';
                button.dataset.originalIcon = originalIcon;
            } else {
                button.disabled = false;
                button.classList.remove('loading');
                const icon = button.querySelector('i');
                icon.className = button.dataset.originalIcon || 'fas fa-file-text';
            }
        }

        // Extract text from uploaded file
        async function ingest() {
            const file = fileInput.files[0];
            if (!file) {
                showNotification('Please choose a file first', 'error');
                return;
            }

            const button = document.querySelector('.card .btn-primary');
            setButtonLoading(button, true);

            try {
                const formData = new FormData();
                formData.append('file', file);
                
                const response = await fetch(`${API}/ingest_resume`, {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    throw new Error('File processing failed');
                }

                const result = await response.json();
                document.getElementById('resume').value = result.text || '';
                showNotification('Resume text extracted successfully!');
                
                // Auto-suggest if text was extracted
                if (result.text && result.text.trim()) {
                    setTimeout(suggest, 1000);
                }
            } catch (error) {
                console.error('Ingestion error:', error);
                showNotification('Failed to process file. Please try again.', 'error');
            } finally {
                setButtonLoading(button, false);
            }
        }

        // Get role suggestions
        async function suggest() {
            const text = document.getElementById('resume').value.trim();
            const k = document.getElementById('k').value || 5;

            if (!text) {
                showNotification('Please paste resume text or upload a file first', 'error');
                return;
            }

            const button = document.querySelector('.controls .btn-success');
            setButtonLoading(button, true);

            try {
                // First get basic results
                const basicResult = await performBasicAnalysis(text, k);
                
                // Then get enhanced analysis for tabs
                await performEnhancedAnalysis(text);
                
            } catch (error) {
                console.error('Suggestion error:', error);
                showNotification('Failed to get suggestions. Please try again.', 'error');
            } finally {
                setButtonLoading(button, false);
            }
        }

        // Enhanced analysis with structured parsing and upskilling
        async function performEnhancedAnalysis(text) {
            try {
                // Step 1: Parse resume (optional - for profile display)
                const profile = await parseResumeText(text);
                
                // Step 2: Display profile (enhanced matches will be populated from table data)
                displayProfile(profile.profile);
                
                // Step 3: Display enhanced matches (will use data from basic results table)
                displayMatches([]);
                
                // Step 4: Generate upskilling plans from table data
                try {
                    // Call displayUpskillingPlans without parameters so it reads from the populated table
                    await displayUpskillingPlans();
                } catch (error) {
                    console.warn('Upskilling analysis not available:', error);
                    displayUpskillingPlans([]);
                }
                
                showNotification(`Enhanced analysis complete! Check the Job Matches tab for detailed results.`);
            } catch (error) {
                console.warn('Enhanced analysis failed, using basic results:', error);
                // Fallback to basic display
                displayProfile(null);
                displayMatches([]);
                displayUpskillingPlans([]);
            }
        }

        // Basic analysis (original functionality)
        async function performBasicAnalysis(text, k) {
            // Try enhanced endpoint first (v1.3.0.0)
            try {
                const url = `${API}/suggest/roles/v2?topk=${encodeURIComponent(k)}&resume_text=${encodeURIComponent(text)}`;
                const response = await fetch(url);

                if (response.ok) {
                    const result = await response.json();
                    renderResults(result.roles || []);
                    showNotification(`Found ${result.roles?.length || 0} career matches with enhanced v1.3.0.0 analysis!`);
                    return result;
                }
            } catch (error) {
                console.warn('Enhanced endpoint failed, falling back to basic:', error);
            }
            
            // Fallback to original endpoint
            const url = `${API}/suggest/roles?topk=${encodeURIComponent(k)}&resume_text=${encodeURIComponent(text)}`;
            const response = await fetch(url);

            if (!response.ok) {
                throw new Error('Failed to get suggestions');
            }

            const result = await response.json();
            renderResults(result.roles || []);
            showNotification(`Found ${result.roles?.length || 0} career matches!`);
            return result;
        }

        // Parse resume text using new endpoint
        async function parseResumeText(text) {
            const response = await fetch(`${API}/parse_resume_json`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ raw_text: text })
            });
            
            if (!response.ok) throw new Error('Resume parsing failed');
            return await response.json();
        }

        // Get job matches using new endpoint
        async function getJobMatches(profile) {
            const jobsResponse = await fetch(`${API}/jobs`);
            const jobs = await jobsResponse.json();
            
            const response = await fetch(`${API}/match`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    candidate: profile.profile,
                    jobs: jobs.slice(0, 5)
                })
            });
            
            if (!response.ok) throw new Error('Job matching failed');
            return await response.json();
        }

        // Generate upskilling plans
        async function generateUpskillingPlans(matches) {
            const gaps = [];
            matches.matches.forEach(match => {
                gaps.push(...match.gaps.map(gap => gap.split(':')[0].trim()));
            });
            
            const uniqueGaps = [...new Set(gaps)];
            
            if (uniqueGaps.length === 0) {
                return { plan: [] };
            }

            const response = await fetch(`${API}/upskill`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    target_role: "Data Engineer",
                    gaps: uniqueGaps.slice(0, 3)
                })
            });
            
            if (!response.ok) throw new Error('Upskilling plan generation failed');
            return await response.json();
        }

        // Display enhanced results - No longer needed, handled in performEnhancedAnalysis
        function displayEnhancedResults(profile, matches, upskillPlans) {
            // This function is deprecated - display is now handled directly in performEnhancedAnalysis
        }

        // Display profile information
        function displayProfile(profile) {
            if (!profile) {
                document.getElementById('profile-content').innerHTML = `
                    <div class="card">
                        <h3 style="color: var(--text-dark);">Profile Analysis</h3>
                        <p>Enhanced profile analysis is not available. Please check the Job Matches tab for role suggestions.</p>
                    </div>
                `;
                return;
            }

            const content = `
                <div class="card" style="margin-bottom: 1rem;">
                    <h3 style="margin-bottom: 1rem; color: var(--text-dark);">Structured Profile Analysis</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                        <div>
                            <h4 style="color: var(--text-dark); margin-bottom: 0.5rem;">Basic Info</h4>
                            <p><strong>Name:</strong> ${profile.name || 'Not detected'}</p>
                            <p><strong>Phone:</strong> ${profile.phone || 'Not detected'}</p>
                            <p><strong>Email:</strong> ${profile.email || 'Not detected'}</p>
                            <p><strong>Location:</strong> ${profile.location || 'Not detected'}</p>
                            <p><strong>Department:</strong> ${profile.dept || 'Not detected'}</p>
                            <p><strong>Seniority:</strong> ${profile.seniority || 'Not detected'}</p>
                        </div>
                        <div>
                            <h4 style="color: var(--text-dark); margin-bottom: 0.5rem;">Skills (${(profile.skills || []).length})</h4>
                            <div class="skills">
                                ${(profile.skills || []).map(skill => `
                                    <span class="skill-tag skill-matched">${skill.name || skill} (Level ${skill.level || 'N/A'})</span>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
                
                                 ${(profile.education || []).length > 0 ? `
                     <div class="card" style="margin-bottom: 1rem;">
                         <h3 style="margin-bottom: 1rem; color: var(--text-dark);">Academic Qualifications</h3>
                         <div style="display: grid; gap: 0.75rem;">
                             ${(profile.education || []).map(edu => `
                                 <div style="padding: 1rem; background: var(--bg); border-radius: var(--radius); border-left: 4px solid var(--primary);">
                                     <div style="font-weight: 600; color: var(--text-dark); margin-bottom: 0.25rem;">
                                         <i class="fas fa-graduation-cap" style="margin-right: 0.5rem; color: var(--primary);"></i>
                                         ${edu}
                                     </div>
                                 </div>
                             `).join('')}
                         </div>
                     </div>
                 ` : ''}
                 
                 ${(profile.certs || []).length > 0 ? `
                     <div class="card" style="margin-bottom: 1rem;">
                         <h3 style="margin-bottom: 1rem; color: var(--text-dark);">Certifications</h3>
                         <div style="display: grid; gap: 0.75rem;">
                             ${(profile.certs || []).map(cert => `
                                 <div style="padding: 1rem; background: var(--bg); border-radius: var(--radius); border-left: 4px solid var(--success);">
                                     <div style="font-weight: 600; color: var(--text-dark); margin-bottom: 0.25rem;">
                                         <i class="fas fa-certificate" style="margin-right: 0.5rem; color: var(--success);"></i>
                                         ${cert}
                                     </div>
                                 </div>
                             `).join('')}
                         </div>
                     </div>
                 ` : ''}
                 
                 ${(profile.projects || []).length > 0 ? `
                     <div class="card" style="margin-bottom: 1rem;">
                         <h3 style="margin-bottom: 1rem; color: var(--text-dark);">Projects</h3>
                         <div style="display: grid; gap: 0.75rem;">
                             ${(profile.projects || []).map(project => `
                                 <div style="padding: 1rem; background: var(--bg); border-radius: var(--radius); border-left: 4px solid var(--warning);">
                                     <div style="font-weight: 600; color: var(--text-dark); margin-bottom: 0.25rem;">
                                         <i class="fas fa-project-diagram" style="margin-right: 0.5rem; color: var(--warning);"></i>
                                         ${project}
                                     </div>
                                 </div>
                             `).join('')}
                         </div>
                     </div>
                 ` : ''}
                 
                 ${(profile.rewards || []).length > 0 ? `
                     <div class="card" style="margin-bottom: 1rem;">
                         <h3 style="margin-bottom: 1rem; color: var(--text-dark);">Awards & Recognition</h3>
                         <div style="display: grid; gap: 0.75rem;">
                             ${(profile.rewards || []).map(reward => `
                                 <div style="padding: 1rem; background: var(--bg); border-radius: var(--radius); border-left: 4px solid var(--error);">
                                     <div style="font-weight: 600; color: var(--text-dark); margin-bottom: 0.25rem;">
                                         <i class="fas fa-trophy" style="margin-right: 0.5rem; color: var(--error);"></i>
                                         ${reward}
                                     </div>
                                 </div>
                             `).join('')}
                         </div>
                     </div>
                 ` : ''}
            `;
            
            document.getElementById('profile-content').innerHTML = content;
        }

        // Display enhanced matches - Updated to use basic results data
        function displayMatches(matches) {
            // Get the basic results data from the table
            const resultsBody = document.getElementById('results-body');
            const rows = resultsBody.querySelectorAll('tr');
            
            if (!rows || rows.length === 0) {
                document.getElementById('matches-content').innerHTML = `
                    <div class="card">
                        <h3 style="color: var(--text-dark);">No Job Matches</h3>
                        <p>No job matches found. Please check the table below for results.</p>
                    </div>
                `;
                return;
            }

            // Convert table data to enhanced display format
            const enhancedMatches = Array.from(rows).map(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length < 4) return null;
                
                const roleCell = cells[0];
                const scoreCell = cells[1];
                const matchedSkillsCell = cells[2];
                const missingSkillsCell = cells[3];
                
                const roleTitle = roleCell.querySelector('.role-title')?.textContent || 'Unknown Role';
                const roleId = roleCell.querySelector('.role-id')?.textContent || '';
                const scoreText = scoreCell.querySelector('.score')?.textContent || '0%';
                const score = parseFloat(scoreText.replace('%', '')) / 100;
                
                const matchedSkills = Array.from(matchedSkillsCell.querySelectorAll('.skill-tag')).map(tag => tag.textContent);
                const missingSkills = Array.from(missingSkillsCell.querySelectorAll('.skill-tag')).map(tag => tag.textContent);
                
                                 return {
                     job_id: roleId,
                     title: roleTitle,
                     score: score,
                     matched_skills: matchedSkills,
                     missing_skills: missingSkills,
                     enhanced_reasons: row.dataset.enhancedReasons ? JSON.parse(row.dataset.enhancedReasons) : []
                 };
            }).filter(match => match !== null);

            const content = enhancedMatches.map(match => {
                const scoreClass = match.score >= 0.8 ? 'score-excellent' : 
                                 match.score >= 0.6 ? 'score-good' : 
                                 match.score >= 0.4 ? 'score-fair' : 'score-poor';
                
                const scoreIcon = match.score >= 0.8 ? 'fas fa-star' : 
                                match.score >= 0.6 ? 'fas fa-thumbs-up' : 
                                match.score >= 0.4 ? 'fas fa-meh' : 'fas fa-thumbs-down';

                return `
                    <div class="card" style="margin-bottom: 1rem;">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
                            <h3 style="color: var(--text-dark);">${match.title}</h3>
                            <div class="score ${scoreClass}">
                                <i class="${scoreIcon}"></i>
                                ${(match.score * 100).toFixed(1)}%
                            </div>
                        </div>
                        
                        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
                            <h4 style="color: var(--text-dark); margin-bottom: 0.5rem;">Why this match? (v1.3.0.0 Enhanced Analysis)</h4>
                            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                <!-- Skills Analysis -->
                                <div class="analysis-card" style="background: var(--bg); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden;">
                                    <details style="cursor: pointer;">
                                        <summary style="display: flex; align-items: center; gap: 0.75rem; padding: 1rem; background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.05)); border-bottom: 1px solid var(--border); list-style: none; font-weight: 600; color: var(--text-dark);">
                                            <div style="width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1rem; background: rgba(16, 185, 129, 0.2); color: #10b981;">
                                                <i class="fas fa-check"></i>
                                            </div>
                                            <div style="flex: 1;">
                                                <div>Skills Analysis (40% weight)</div>
                                                <div style="font-size: 0.875rem; color: var(--muted); font-weight: 400;">
                                                    ${match.matched_skills.length} skills aligned • ${Math.round(match.score * 40)}% contribution
                                                </div>
                                            </div>
                                            <div style="font-size: 1.2rem; color: #10b981; transition: transform 0.3s ease;">▼</div>
                                        </summary>
                                        <div style="padding: 1rem; background: var(--bg-light);">
                                            ${match.matched_skills.length > 0 ? `
                                                <div style="margin-bottom: 1rem;">
                                                    <h5 style="color: var(--text-dark); margin-bottom: 0.5rem; font-size: 0.9rem;">✅ Matched Skills:</h5>
                                                    <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                                                        ${match.matched_skills.map(skill => `
                                                            <span style="padding: 0.25rem 0.75rem; background: rgba(16, 185, 129, 0.2); color: #10b981; border-radius: 12px; font-size: 0.8rem; font-weight: 500;">
                                                                ${skill}
                                                            </span>
                                                        `).join('')}
                                                    </div>
                                                </div>
                                            ` : ''}
                                            ${match.missing_skills.length > 0 ? `
                                                <div style="margin-bottom: 1rem;">
                                                    <h5 style="color: var(--text-dark); margin-bottom: 0.5rem; font-size: 0.9rem;">❌ Missing Skills:</h5>
                                                    <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                                                        ${match.missing_skills.map(skill => `
                                                            <span style="padding: 0.25rem 0.75rem; background: rgba(239, 68, 68, 0.2); color: #ef4444; border-radius: 12px; font-size: 0.8rem; font-weight: 500;">
                                                                ${skill}
                                                            </span>
                                                        `).join('')}
                                                    </div>
                                                </div>
                                            ` : ''}
                                            <div style="font-size: 0.85rem; color: var(--text-gray); line-height: 1.5;">
                                                <strong>Analysis:</strong> Skills are the most critical factor in job matching. We evaluate both required and nice-to-have skills, with higher scores for skills that directly match the job requirements. Each matched skill contributes to your overall fit score.
                                            </div>
                                        </div>
                                    </details>
                                </div>

                                <!-- Project Analysis -->
                                <div class="analysis-card" style="background: var(--bg); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden;">
                                    <details style="cursor: pointer;">
                                        <summary style="display: flex; align-items: center; gap: 0.75rem; padding: 1rem; background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.05)); border-bottom: 1px solid var(--border); list-style: none; font-weight: 600; color: var(--text-dark);">
                                            <div style="width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1rem; background: rgba(245, 158, 11, 0.2); color: #f59e0b;">
                                                <i class="fas fa-project-diagram"></i>
                                            </div>
                                            <div style="flex: 1;">
                                                <div>Project Analysis (25% weight)</div>
                                                <div style="font-size: 0.875rem; color: var(--muted); font-weight: 400;">
                                                    Project relevance evaluated • ${Math.round(match.score * 25)}% contribution
                                                </div>
                                            </div>
                                            <div style="font-size: 1.2rem; color: #f59e0b; transition: transform 0.3s ease;">▼</div>
                                        </summary>
                                        <div style="padding: 1rem; background: var(--bg-light);">
                                            <div style="margin-bottom: 1rem;">
                                                <h5 style="color: var(--text-dark); margin-bottom: 0.5rem; font-size: 0.9rem;">🔍 Project Evaluation:</h5>
                                                <div style="background: var(--bg); padding: 1rem; border-radius: var(--radius); border-left: 4px solid #f59e0b;">
                                                    <div style="font-size: 0.85rem; color: var(--text-gray); line-height: 1.5;">
                                                        <strong>How it works:</strong> We analyze your project descriptions for keywords and technologies that match the job requirements. Projects that demonstrate relevant technical skills, problem-solving abilities, and domain knowledge receive higher scores.
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="font-size: 0.85rem; color: var(--text-gray); line-height: 1.5;">
                                                <strong>Impact:</strong> Relevant projects show practical application of skills and demonstrate your ability to deliver real-world solutions. They're particularly valuable for technical roles where hands-on experience is crucial.
                                            </div>
                                        </div>
                                    </details>
                                </div>

                                <!-- Education Analysis -->
                                <div class="analysis-card" style="background: var(--bg); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden;">
                                    <details style="cursor: pointer;">
                                        <summary style="display: flex; align-items: center; gap: 0.75rem; padding: 1rem; background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(139, 92, 246, 0.05)); border-bottom: 1px solid var(--border); list-style: none; font-weight: 600; color: var(--text-dark);">
                                            <div style="width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1rem; background: rgba(139, 92, 246, 0.2); color: #8b5cf6;">
                                                <i class="fas fa-graduation-cap"></i>
                                            </div>
                                            <div style="flex: 1;">
                                                <div>Education Analysis (20% weight)</div>
                                                <div style="font-size: 0.875rem; color: var(--muted); font-weight: 400;">
                                                    Degree relevance assessed • ${Math.round(match.score * 20)}% contribution
                                                </div>
                                            </div>
                                            <div style="font-size: 1.2rem; color: #8b5cf6; transition: transform 0.3s ease;">▼</div>
                                        </summary>
                                        <div style="padding: 1rem; background: var(--bg-light);">
                                            <div style="margin-bottom: 1rem;">
                                                <h5 style="color: var(--text-dark); margin-bottom: 0.5rem; font-size: 0.9rem;">🎓 Education Evaluation:</h5>
                                                <div style="background: var(--bg); padding: 1rem; border-radius: var(--radius); border-left: 4px solid #8b5cf6;">
                                                    <div style="font-size: 0.85rem; color: var(--text-gray); line-height: 1.5;">
                                                        <strong>Degree Level:</strong> We assess whether your education level matches the job's seniority requirements. Senior positions typically require higher degrees, while entry-level roles may accept bachelor's degrees.
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="font-size: 0.85rem; color: var(--text-gray); line-height: 1.5;">
                                                <strong>Field Relevance:</strong> We evaluate how closely your field of study aligns with the job requirements. Degrees in related fields (e.g., Computer Science for software engineering) receive higher scores than unrelated degrees.
                                            </div>
                                        </div>
                                    </details>
                                </div>

                                <!-- Experience Analysis -->
                                <div class="analysis-card" style="background: var(--bg); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden;">
                                    <details style="cursor: pointer;">
                                        <summary style="display: flex; align-items: center; gap: 0.75rem; padding: 1rem; background: linear-gradient(135deg, rgba(14, 165, 233, 0.1), rgba(14, 165, 233, 0.05)); border-bottom: 1px solid var(--border); list-style: none; font-weight: 600; color: var(--text-dark);">
                                            <div style="width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1rem; background: rgba(14, 165, 233, 0.2); color: #0ea5e9;">
                                                <i class="fas fa-briefcase"></i>
                                            </div>
                                            <div style="flex: 1;">
                                                <div>Experience Analysis (10% weight)</div>
                                                <div style="font-size: 0.875rem; color: var(--muted); font-weight: 400;">
                                                    Work experience evaluated • ${Math.round(match.score * 10)}% contribution
                                                </div>
                                            </div>
                                            <div style="font-size: 1.2rem; color: #0ea5e9; transition: transform 0.3s ease;">▼</div>
                                        </summary>
                                        <div style="padding: 1rem; background: var(--bg-light);">
                                            <div style="font-size: 0.85rem; color: var(--text-gray); line-height: 1.5;">
                                                <strong>Experience Matching:</strong> We evaluate your work history for roles that are relevant to the target position. Previous experience in similar roles or industries demonstrates your ability to perform the required duties and adapt to the work environment.
                                            </div>
                                        </div>
                                    </details>
                                </div>

                                <!-- Domain & Location Analysis -->
                                <div class="analysis-card" style="background: var(--bg); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden;">
                                    <details style="cursor: pointer;">
                                        <summary style="display: flex; align-items: center; gap: 0.75rem; padding: 1rem; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(99, 102, 241, 0.05)); border-bottom: 1px solid var(--border); list-style: none; font-weight: 600; color: var(--text-dark);">
                                            <div style="width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1rem; background: rgba(99, 102, 241, 0.2); color: #6366f1;">
                                                <i class="fas fa-building"></i>
                                            </div>
                                            <div style="flex: 1;">
                                                <div>Domain & Location (5% weight)</div>
                                                <div style="font-size: 0.875rem; color: var(--muted); font-weight: 400;">
                                                    Department & geographic fit • ${Math.round(match.score * 5)}% contribution
                                                </div>
                                            </div>
                                            <div style="font-size: 1.2rem; color: #6366f1; transition: transform 0.3s ease;">▼</div>
                                        </summary>
                                        <div style="padding: 1rem; background: var(--bg-light);">
                                            <div style="font-size: 0.85rem; color: var(--text-gray); line-height: 1.5;">
                                                <strong>Domain Match:</strong> We evaluate whether your background aligns with the company's industry or department. Experience in similar domains can provide valuable context and industry knowledge.
                                            </div>
                                            <div style="font-size: 0.85rem; color: var(--text-gray); line-height: 1.5; margin-top: 0.5rem;">
                                                <strong>Location Compatibility:</strong> Geographic considerations include whether you're willing to relocate, work remotely, or commute to the job location. This affects practical feasibility of the role.
                                            </div>
                                        </div>
                                    </details>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
                            <h4 style="color: var(--text-dark); margin-bottom: 0.5rem;">Your Matched Skills</h4>
                            <div class="skills">
                                ${match.matched_skills.map(skill => `
                                    <span class="skill-tag skill-matched">${skill}</span>
                                `).join('')}
                            </div>
                        </div>

                        ${match.missing_skills.length > 0 ? `
                            <div style="margin-top: 1rem;">
                                <h4 style="color: var(--text-dark); margin-bottom: 0.5rem;">Skills to Learn</h4>
                                <div class="skills">
                                    ${match.missing_skills.map(skill => `
                                        <span class="skill-tag skill-missing">${skill}</span>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');

            document.getElementById('matches-content').innerHTML = content;
        }

        // Display upskilling plans
        async function displayUpskillingPlans(plans = null) {
            // If plans parameter is provided, use it (fallback mode)
            if (plans !== null) {
                // Fallback to basic upskilling display
                const upskillingContent = generateUpskillingRecommendations(plans, []);
                document.getElementById('upskill-content').innerHTML = upskillingContent;
                return;
            }
            
            // Get missing skills from the results table
            const resultsBody = document.getElementById('results-body');
            const rows = resultsBody.querySelectorAll('tr');
            
            console.log('🔍 Debug: Found', rows.length, 'rows in results table');
            
            if (!rows || rows.length === 0) {
                document.getElementById('upskill-content').innerHTML = `
                    <div class="card">
                        <h3 style="color: var(--text-dark);">Upskilling Recommendations</h3>
                        <p>No job matches found. Please run a search first to get personalized upskilling recommendations.</p>
                    </div>
                `;
                return;
            }

            // Collect all missing skills and job matches data
            const allMissingSkills = new Set();
            const jobMatches = [];
            const resumeSkills = new Set();
            
            rows.forEach((row, index) => {
                const cells = row.querySelectorAll('td');
                console.log(`🔍 Debug: Row ${index} has ${cells.length} cells`);
                
                if (cells.length >= 4) {
                    const roleTitle = cells[0].querySelector('.role-title')?.textContent || 'Unknown Role';
                    const scoreText = cells[1].querySelector('.score')?.textContent || '0%';
                    const score = parseFloat(scoreText.replace('%', '')) / 100;
                    const matchedSkills = Array.from(cells[2].querySelectorAll('.skill-tag')).map(tag => tag.textContent);
                    const missingSkills = Array.from(cells[3].querySelectorAll('.skill-tag')).map(tag => tag.textContent);
                    
                    console.log(`🔍 Debug: Row ${index} - Role: ${roleTitle}, Score: ${score}, Matched: ${matchedSkills.length}, Missing: ${missingSkills.length}`);
                    console.log(`🔍 Debug: Missing skills:`, missingSkills);
                    
                    // Add to resume skills
                    matchedSkills.forEach(skill => resumeSkills.add(skill.toLowerCase()));
                    
                    // Add to missing skills
                    missingSkills.forEach(skill => allMissingSkills.add(skill));
                    
                    // Add to job matches
                    jobMatches.push({
                        title: roleTitle,
                        score: score,
                        missing_skills: missingSkills
                    });
                }
            });

            console.log('🔍 Debug: Total missing skills collected:', Array.from(allMissingSkills));
            console.log('🔍 Debug: Job matches:', jobMatches);
            console.log('🔍 Debug: Resume skills collected:', Array.from(resumeSkills));

            // Store resume skills globally for role-specific upskilling
            window.originalResumeSkills = Array.from(resumeSkills);

            // Populate the role dropdown with job matches
            populateRoleDropdown(jobMatches);

            // Determine target role (highest scoring job match)
            let targetRole = 'auto';
            if (jobMatches.length > 0) {
                const bestMatch = jobMatches.reduce((best, current) => 
                    current.score > best.score ? current : best
                );
                targetRole = bestMatch.title;
            }
            
            console.log(`🎯 Target role for upskilling: ${targetRole}`);

            // If no missing skills detected, create some default recommendations based on the job matches
            if (allMissingSkills.size === 0 && jobMatches.length > 0) {
                console.log('🔍 Debug: No missing skills detected, creating default recommendations');
                
                // Get the highest scoring job to determine target role
                const bestMatch = jobMatches.reduce((best, current) => 
                    current.score > best.score ? current : best
                );
                
                // Create default missing skills based on common requirements for the role
                const defaultSkills = getDefaultSkillsForRole(bestMatch.title);
                
                // Add default skills to the job matches
                jobMatches.forEach(match => {
                    if (match.missing_skills.length === 0) {
                        match.missing_skills = [...defaultSkills];
                    }
                });
                
                // Update allMissingSkills set
                defaultSkills.forEach(skill => allMissingSkills.add(skill));
                
                console.log('🔍 Debug: Added default skills:', defaultSkills);
            }

            try {
                // Call enhanced upskilling API with target role
                const response = await fetch(`${API}/upskill/enhanced`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        resume_skills: Array.from(resumeSkills),
                        job_matches: jobMatches,
                        target_role: targetRole
                    })
                });

                if (!response.ok) {
                    throw new Error('Failed to get enhanced upskilling recommendations');
                }

                const upskillingData = await response.json();
                console.log('🔍 Debug: Backend upskilling response:', upskillingData);
                console.log('🔍 Debug: Priority skills count:', upskillingData.priority_skills ? upskillingData.priority_skills.length : 0);
                console.log('🔍 Debug: Skill recommendations count:', upskillingData.skill_recommendations ? upskillingData.skill_recommendations.length : 0);
                console.log('🔍 Debug: Priority skills:', upskillingData.priority_skills);
                console.log('🔍 Debug: Skill recommendations:', upskillingData.skill_recommendations);
                
                // Always use the backend response - it should have the correct data
                const upskillingContent = generateEnhancedUpskillingContent(upskillingData);
                document.getElementById('upskill-content').innerHTML = upskillingContent;
                
            } catch (error) {
                console.warn('Enhanced upskilling failed, falling back to basic:', error);
                // Fallback to basic upskilling
                const upskillingContent = generateUpskillingRecommendations(Array.from(allMissingSkills), jobMatches);
                document.getElementById('upskill-content').innerHTML = upskillingContent;
            }
        }
        
        // Helper function to get default skills for a role
        function getDefaultSkillsForRole(roleTitle) {
            const roleLower = roleTitle.toLowerCase();
            
            if (roleLower.includes('data scientist') || roleLower.includes('data science')) {
                return ['machine learning', 'statistics', 'python', 'sql', 'aws'];
            } else if (roleLower.includes('nlp engineer') || roleLower.includes('natural language processing')) {
                return ['natural language processing', 'machine learning', 'python', 'tensorflow', 'pytorch'];
            } else if (roleLower.includes('machine learning engineer') || roleLower.includes('ml engineer')) {
                return ['machine learning', 'deep learning', 'python', 'tensorflow', 'aws'];
            } else if (roleLower.includes('software engineer') || roleLower.includes('developer')) {
                return ['react', 'docker', 'aws', 'kubernetes', 'microservices'];
            } else if (roleLower.includes('data engineer')) {
                return ['apache spark', 'airflow', 'aws', 'docker', 'kubernetes'];
            } else if (roleLower.includes('devops')) {
                return ['kubernetes', 'terraform', 'jenkins', 'prometheus', 'ansible'];
            } else if (roleLower.includes('frontend')) {
                return ['react', 'typescript', 'vue.js', 'webpack', 'css3'];
            } else if (roleLower.includes('backend')) {
                return ['node.js', 'python', 'java', 'docker', 'postgresql'];
            } else if (roleLower.includes('full stack')) {
                return ['react', 'node.js', 'docker', 'aws', 'postgresql'];
            } else if (roleLower.includes('cloud engineer')) {
                return ['aws', 'azure', 'gcp', 'docker', 'kubernetes'];
            } else if (roleLower.includes('ai engineer') || roleLower.includes('artificial intelligence')) {
                return ['machine learning', 'deep learning', 'python', 'tensorflow', 'pytorch'];
            } else {
                // Default skills for any role
                return ['python', 'sql', 'docker', 'aws', 'git'];
            }
        }

                 // Generate enhanced upskilling content from backend data
         function generateEnhancedUpskillingContent(upskillingData) {
             const { overall_strategy, target_role, skill_recommendations, priority_skills, job_category_info } = upskillingData;
             
             console.log('🔍 Debug: generateEnhancedUpskillingContent called with:', upskillingData);
             console.log('🔍 Debug: skill_recommendations:', skill_recommendations);
             console.log('🔍 Debug: priority_skills:', priority_skills);
             console.log('🔍 Debug: job_category_info:', job_category_info);
             
             // Generate overall strategy section
             const overallStrategy = `
                 <div class="card" style="margin-bottom: 2rem; background: linear-gradient(135deg, rgba(14, 165, 233, 0.1), rgba(16, 185, 129, 0.1)); border: 1px solid var(--primary);">
                     <h3 style="color: var(--text-dark); margin-bottom: 1rem;">🎯 Overall Improvement Strategy</h3>
                     <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1rem;">
                         <div>
                             <h4 style="color: var(--text-dark); margin-bottom: 0.5rem; font-size: 1rem;">Current Status</h4>
                             <div style="background: var(--bg); padding: 1rem; border-radius: var(--radius);">
                                 <div style="font-size: 0.875rem; color: var(--muted); margin-bottom: 0.5rem;">Highest Match Score</div>
                                 <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary);">${overall_strategy.currentScore}%</div>
                                 <div style="font-size: 0.875rem; color: var(--text-gray); margin-top: 0.25rem;">
                                     ${priority_skills.length > 0 ? priority_skills.length + ' skills to improve' : 'Skills well-aligned'}
                                 </div>
                             </div>
                         </div>
                         <div>
                             <h4 style="color: var(--text-dark); margin-bottom: 0.5rem; font-size: 1rem;">Target Goal</h4>
                             <div style="background: var(--bg); padding: 1rem; border-radius: var(--radius);">
                                 <div style="font-size: 0.875rem; color: var(--muted); margin-bottom: 0.5rem;">Target Match Score</div>
                                 <div style="font-size: 1.5rem; font-weight: 700; color: var(--success);">${overall_strategy.targetScore}%</div>
                                 <div style="font-size: 0.875rem; color: var(--text-gray); margin-top: 0.25rem;">
                                     +${overall_strategy.improvementNeeded}% improvement needed
                                 </div>
                             </div>
                         </div>
                     </div>
                     <div style="background: var(--bg); padding: 1rem; border-radius: var(--radius); margin-bottom: 1rem;">
                         <h4 style="color: var(--text-dark); margin-bottom: 0.5rem; font-size: 1rem;">🎯 Target Role: ${target_role}</h4>
                         <div style="color: var(--text-gray); line-height: 1.6;">
                             <p style="margin-bottom: 0.5rem;">Focus on developing skills for <strong>${target_role}</strong> role</p>
                             ${job_category_info && job_category_info.description ? 
                                 `<p style="font-size: 0.875rem; color: var(--muted); margin-bottom: 0.5rem;">${job_category_info.description}</p>` : 
                                 '<p style="font-size: 0.875rem; color: var(--muted);">Based on your resume analysis and job matches.</p>'
                             }
                             ${job_category_info && job_category_info.prioritySkills ? 
                                 `<p style="font-size: 0.875rem; color: var(--primary);">Key skills for this role: ${job_category_info.prioritySkills.slice(0, 3).join(', ')}${job_category_info.prioritySkills.length > 3 ? '...' : ''}</p>` : 
                                 ''
                             }
                         </div>
                     </div>
                     <div style="background: var(--bg); padding: 1rem; border-radius: var(--radius);">
                         <h4 style="color: var(--text-dark); margin-bottom: 0.5rem; font-size: 1rem;">📈 Action Plan</h4>
                         <ul style="color: var(--text-gray); line-height: 1.6; padding-left: 1.5rem;">
                             <li>Focus on <strong>${overall_strategy.totalSkillsToLearn > 0 ? overall_strategy.totalSkillsToLearn : 'continuous improvement'}</strong> ${overall_strategy.totalSkillsToLearn > 0 ? 'priority skills identified' : 'areas'}</li>
                             <li>Complete recommended courses and projects for each skill</li>
                             <li>Build portfolio projects to demonstrate practical expertise</li>
                             <li>Target completion: <strong>${overall_strategy.estimatedWeeks} weeks</strong></li>
                         </ul>
                     </div>
                 </div>
             `;
             
                              // Generate summary card with all skills, courses, and projects
             const allSkills = skill_recommendations ? skill_recommendations.map(r => r.skill.charAt(0).toUpperCase() + r.skill.slice(1)) : [];
             const allCourses = skill_recommendations ? skill_recommendations.flatMap(r => r.resources || []) : [];
             const allProjects = skill_recommendations ? skill_recommendations.flatMap(r => r.projects || []) : [];
             
             console.log('🔍 Debug: allSkills:', allSkills);
             console.log('🔍 Debug: allSkills.length:', allSkills.length);
             console.log('🔍 Debug: skill_recommendations type:', typeof skill_recommendations);
             console.log('🔍 Debug: skill_recommendations:', skill_recommendations);
             
             // If no skills are recommended, show a message about continuous improvement
             if (allSkills.length === 0) {
                 console.log('🔍 Debug: Showing continuous improvement because allSkills.length is 0');
                 
                 // Add role-specific certifications and projects if available
                 let roleSpecificContent = '';
                 if (job_category_info) {
                     const certifications = job_category_info.certifications || [];
                     const projects = job_category_info.projects || [];
                     
                     if (certifications.length > 0 || projects.length > 0) {
                         roleSpecificContent = `
                             <div class="card" style="margin-bottom: 2rem; background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(34, 197, 94, 0.1)); border: 1px solid #10b981;">
                                 <h3 style="color: var(--text-dark); margin-bottom: 1.5rem;">🎯 Role-Specific Recommendations</h3>
                                 
                                 ${certifications.length > 0 ? `
                                     <div style="background: var(--bg); padding: 1.5rem; border-radius: var(--radius); margin-bottom: 1rem;">
                                         <h4 style="color: var(--text-dark); margin-bottom: 1rem;">🏆 Recommended Certifications</h4>
                                         <div style="display: grid; gap: 1rem;">
                                             ${certifications.map(cert => `
                                                 <div style="padding: 1rem; border: 1px solid var(--border); border-radius: var(--radius);">
                                                     <div style="font-weight: 600; color: var(--text-dark);">${cert.name}</div>
                                                     <div style="font-size: 0.875rem; color: var(--muted);">${cert.platform}</div>
                                                     <div style="font-size: 0.875rem; color: var(--text-gray); margin-top: 0.5rem;">${cert.description}</div>
                                                 </div>
                                             `).join('')}
                                         </div>
                                     </div>
                                 ` : ''}
                                 
                                 ${projects.length > 0 ? `
                                     <div style="background: var(--bg); padding: 1.5rem; border-radius: var(--radius); margin-bottom: 1rem;">
                                         <h4 style="color: var(--text-dark); margin-bottom: 1rem;">🚀 Portfolio Projects</h4>
                                         <div style="display: grid; gap: 1rem;">
                                             ${projects.map(project => `
                                                 <div style="padding: 1rem; border: 1px solid var(--border); border-radius: var(--radius);">
                                                     <div style="font-weight: 600; color: var(--text-dark);">${project.name}</div>
                                                     <div style="font-size: 0.875rem; color: var(--muted);">Difficulty: ${project.difficulty}</div>
                                                     <div style="font-size: 0.875rem; color: var(--text-gray); margin-top: 0.5rem;">${project.description}</div>
                                                 </div>
                                             `).join('')}
                                         </div>
                                     </div>
                                 ` : ''}
                             </div>
                         `;
                     }
                 }
                 
                 const continuousImprovementCard = `
                     <div class="card" style="margin-bottom: 2rem; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(168, 85, 247, 0.1)); border: 1px solid var(--primary);">
                         <h3 style="color: var(--text-dark); margin-bottom: 1.5rem;">🎯 Continuous Improvement Strategy</h3>
                         
                         <div style="background: var(--bg); padding: 1.5rem; border-radius: var(--radius); margin-bottom: 1.5rem;">
                             <h4 style="color: var(--text-dark); margin-bottom: 1rem;">Great Job! 🎉</h4>
                             <p style="color: var(--text-gray); line-height: 1.6; margin-bottom: 1rem;">
                                 Your current skills are well-aligned with the target role. However, continuous learning is key to staying competitive in the tech industry.
                             </p>
                             <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1.5rem;">
                                 <div style="text-align: center; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: var(--radius);">
                                     <div style="font-size: 2rem; margin-bottom: 0.5rem;">📚</div>
                                     <div style="font-weight: 600; color: var(--text-dark);">Advanced Courses</div>
                                     <div style="font-size: 0.875rem; color: var(--muted);">Take your skills to the next level</div>
                                 </div>
                                 <div style="text-align: center; padding: 1rem; background: rgba(245, 158, 11, 0.1); border-radius: var(--radius);">
                                     <div style="font-size: 2rem; margin-bottom: 0.5rem;">🚀</div>
                                     <div style="font-weight: 600; color: var(--text-dark);">Portfolio Projects</div>
                                     <div style="font-size: 0.875rem; color: var(--muted);">Build impressive projects</div>
                                 </div>
                                 <div style="text-align: center; padding: 1rem; background: rgba(239, 68, 68, 0.1); border-radius: var(--radius);">
                                     <div style="font-size: 2rem; margin-bottom: 0.5rem;">🏆</div>
                                     <div style="font-weight: 600; color: var(--text-dark);">Certifications</div>
                                     <div style="font-size: 0.875rem; color: var(--muted);">Validate your expertise</div>
                                 </div>
                             </div>
                         </div>
                     </div>
                 `;
                 return overallStrategy + roleSpecificContent + continuousImprovementCard;
             }
             
             const summaryCard = `
                 <div class="card" style="margin-bottom: 2rem; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(168, 85, 247, 0.1)); border: 1px solid var(--primary);">
                     <h3 style="color: var(--text-dark); margin-bottom: 1.5rem;">📋 Complete Learning Roadmap</h3>
                     
                     <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
                         <div style="background: var(--bg); padding: 1.5rem; border-radius: var(--radius); border-left: 4px solid #ef4444;">
                             <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                 <div style="width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; background: rgba(239, 68, 68, 0.2); color: #ef4444;">
                                     <i class="fas fa-code"></i>
                                 </div>
                                 <h4 style="color: var(--text-dark); margin: 0;">Skills to Master</h4>
                             </div>
                             <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                                 ${allSkills.map(skill => `
                                     <span style="background: rgba(239, 68, 68, 0.1); color: #ef4444; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.875rem; font-weight: 500; border: 1px solid rgba(239, 68, 68, 0.3);">
                                         ${skill}
                                     </span>
                                 `).join('')}
                             </div>
                             <p style="font-size: 0.875rem; color: var(--text-gray); margin-top: 1rem; line-height: 1.5;">
                                 ${allSkills.length > 0 ? 
                                     `Focus on these ${allSkills.length} priority skills to improve your job match score from ${overall_strategy.currentScore}% to ${overall_strategy.targetScore}%.` :
                                     `Your skills are well-aligned! Focus on continuous improvement to maintain your competitive edge.`
                                 }
                             </p>
                         </div>
                         
                         <div style="background: var(--bg); padding: 1.5rem; border-radius: var(--radius); border-left: 4px solid #10b981;">
                             <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                 <div style="width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; background: rgba(16, 185, 129, 0.2); color: #10b981;">
                                     <i class="fas fa-graduation-cap"></i>
                                 </div>
                                 <h4 style="color: var(--text-dark); margin: 0;">Recommended Courses</h4>
                             </div>
                             <div style="max-height: 200px; overflow-y: auto;">
                                 ${allCourses.slice(0, 5).map(course => `
                                     <div style="padding: 0.75rem; background: rgba(16, 185, 129, 0.05); border-radius: var(--radius); margin-bottom: 0.5rem; border-left: 3px solid #10b981;">
                                         <div style="font-weight: 600; color: var(--text-dark); font-size: 0.875rem; margin-bottom: 0.25rem;">${course.name}</div>
                                         <div style="font-size: 0.75rem; color: var(--muted);">${course.platform} • ${course.hours} hours</div>
                                     </div>
                                 `).join('')}
                                 ${allCourses.length > 5 ? `<div style="text-align: center; color: var(--muted); font-size: 0.875rem; margin-top: 0.5rem;">+${allCourses.length - 5} more courses</div>` : ''}
                             </div>
                         </div>
                         
                         <div style="background: var(--bg); padding: 1.5rem; border-radius: var(--radius); border-left: 4px solid #f59e0b;">
                             <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                 <div style="width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; background: rgba(245, 158, 11, 0.2); color: #f59e0b;">
                                     <i class="fas fa-project-diagram"></i>
                                 </div>
                                 <h4 style="color: var(--text-dark); margin: 0;">Project Ideas</h4>
                             </div>
                             <div style="max-height: 200px; overflow-y: auto;">
                                 ${allProjects.slice(0, 5).map(project => `
                                     <div style="padding: 0.75rem; background: rgba(245, 158, 11, 0.05); border-radius: var(--radius); margin-bottom: 0.5rem; border-left: 3px solid #f59e0b;">
                                         <div style="font-weight: 600; color: var(--text-dark); font-size: 0.875rem; margin-bottom: 0.25rem;">${project.title}</div>
                                         <div style="font-size: 0.75rem; color: var(--text-gray); line-height: 1.4;">${project.description.substring(0, 80)}${project.description.length > 80 ? '...' : ''}</div>
                                     </div>
                                 `).join('')}
                                 ${allProjects.length > 5 ? `<div style="text-align: center; color: var(--muted); font-size: 0.875rem; margin-top: 0.5rem;">+${allProjects.length - 5} more projects</div>` : ''}
                             </div>
                         </div>
                     </div>
                     
                     <div style="background: var(--bg); padding: 1rem; border-radius: var(--radius); text-align: center;">
                         <p style="color: var(--text-gray); margin: 0; font-size: 0.875rem;">
                             <strong>Total Learning Time:</strong> ~${Math.ceil(allCourses.reduce((sum, course) => sum + (course.hours || 0), 0) / 10)} weeks 
                             <span style="color: var(--muted);">(assuming 10 hours/week)</span>
                         </p>
                     </div>
                 </div>
             `;
             
             // Generate skill-specific recommendations
             const skillCards = skill_recommendations.map(recommendation => {
                 const { skill, type, difficulty, timeToLearn, isPriorityForRole, resources, projects, roleRelevance } = recommendation;
                 
                 const priorityBadge = isPriorityForRole ? 
                     '<span style="background: #ef4444; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: 500; margin-left: 0.5rem;">High Priority</span>' : '';
                 
                 const relevanceColor = roleRelevance === 'High Priority' ? '#ef4444' : 
                                      roleRelevance === 'Secondary' ? '#f59e0b' : '#6b7280';
                 
                 return `
                     <div class="card" style="margin-bottom: 1.5rem; border-left: 4px solid var(--primary);">
                         <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
                             <div>
                                 <h3 style="color: var(--text-dark); margin-bottom: 0.5rem;">${skill.charAt(0).toUpperCase() + skill.slice(1)} ${priorityBadge}</h3>
                                 <div style="display: flex; gap: 1rem; font-size: 0.875rem; color: var(--muted);">
                                     <span>${type}</span>
                                     <span>•</span>
                                     <span>${difficulty}</span>
                                     <span>•</span>
                                     <span>${timeToLearn}</span>
                                     <span>•</span>
                                     <span style="color: ${relevanceColor};">${roleRelevance}</span>
                                 </div>
                             </div>
                             <span style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.875rem; font-weight: 500;">
                                 ${timeToLearn}
                             </span>
                         </div>
                         
                         <div style="margin-bottom: 1.5rem;">
                             <h4 style="color: var(--text-dark); margin-bottom: 0.75rem; font-size: 1rem;">📚 Learning Resources</h4>
                             <div style="display: grid; gap: 0.75rem;">
                                 ${resources.map(resource => `
                                     <div style="padding: 1rem; background: var(--bg); border-radius: var(--radius); border-left: 3px solid var(--success);">
                                         <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                                             <div style="width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1rem; background: rgba(16, 185, 129, 0.2); color: #10b981;">
                                                 <i class="fas fa-graduation-cap"></i>
                                             </div>
                                             <div>
                                                 <div style="font-weight: 600; color: var(--text-dark);">${resource.name}</div>
                                                 <div style="font-size: 0.875rem; color: var(--muted);">
                                                     ${resource.type} • ${resource.platform} • ${resource.hours} hours
                                                 </div>
                                             </div>
                                         </div>
                                         <div style="font-size: 0.875rem; color: var(--text-gray); line-height: 1.5;">
                                             ${resource.description}
                                         </div>
                                     </div>
                                 `).join('')}
                             </div>
                         </div>

                         <div>
                             <h4 style="color: var(--text-dark); margin-bottom: 0.75rem; font-size: 1rem;">🚀 Project Ideas</h4>
                             <div style="display: grid; gap: 0.75rem;">
                                 ${projects.map(project => `
                                     <div style="padding: 1rem; background: var(--bg); border-radius: var(--radius); border-left: 3px solid var(--warning);">
                                         <div style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 0.5rem;">
                                             <div style="width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1rem; background: rgba(245, 158, 11, 0.2); color: #f59e0b; flex-shrink: 0;">
                                                 <i class="fas fa-project-diagram"></i>
                                             </div>
                                             <div style="flex: 1;">
                                                 <div style="font-weight: 600; color: var(--text-dark); margin-bottom: 0.25rem;">${project.title}</div>
                                                 <div style="font-size: 0.875rem; color: var(--text-gray); line-height: 1.5;">
                                                     ${project.description}
                                                 </div>
                                             </div>
                                         </div>
                                     </div>
                                 `).join('')}
                             </div>
                         </div>
                     </div>
                 `;
             }).join('');
             
             return overallStrategy + summaryCard + skillCards;
         }

         // Generate comprehensive upskilling recommendations (fallback)
         function generateUpskillingRecommendations(missingSkills, matchData) {
                         const skillRecommendations = {
                 'Python': {
                     type: 'Programming Language',
                     difficulty: 'Intermediate',
                     timeToLearn: '4-6 weeks',
                     resources: [
                         { 
                             name: 'Python for Data Science', 
                             type: 'Course', 
                             platform: 'Coursera', 
                             hours: 40, 
                             description: 'Comprehensive course covering Python fundamentals, data manipulation with pandas, visualization with matplotlib, and basic machine learning concepts. Perfect for beginners transitioning to data science.'
                         },
                         { 
                             name: 'Python Crash Course', 
                             type: 'Book', 
                             platform: 'No Starch Press', 
                             hours: 60, 
                             description: 'Hands-on book with practical projects covering web development, data visualization, and game development. Includes exercises and real-world applications.'
                         },
                         { 
                             name: 'Real Python Tutorials', 
                             type: 'Tutorial', 
                             platform: 'Real Python', 
                             hours: 20, 
                             description: 'Free, high-quality tutorials covering Python basics, web development, data science, and advanced topics. Great for self-paced learning.'
                         }
                     ],
                     projects: [
                         {
                             title: 'Web Scraper with BeautifulSoup',
                             description: 'Build a web scraper that extracts data from websites, handles different HTML structures, and saves data to CSV/JSON files. Learn about HTTP requests, HTML parsing, and data cleaning.'
                         },
                         {
                             title: 'Data Analysis Dashboard with Streamlit',
                             description: 'Create an interactive web application for data visualization and analysis. Include charts, filters, and real-time data updates. Perfect for showcasing data science skills.'
                         },
                         {
                             title: 'REST API with FastAPI',
                             description: 'Develop a modern, fast web API with automatic documentation, data validation, and async support. Include CRUD operations, authentication, and database integration.'
                         }
                     ]
                 },
                                 'SQL': {
                     type: 'Database Language',
                     difficulty: 'Beginner',
                     timeToLearn: '2-3 weeks',
                     resources: [
                         { 
                             name: 'SQL for Data Science', 
                             type: 'Course', 
                             platform: 'DataCamp', 
                             hours: 25, 
                             description: 'Interactive course focusing on SQL queries for data analysis, including joins, aggregations, window functions, and optimization techniques. Includes hands-on exercises with real datasets.'
                         },
                         { 
                             name: 'SQL Tutorial', 
                             type: 'Tutorial', 
                             platform: 'W3Schools', 
                             hours: 15, 
                             description: 'Free comprehensive tutorial covering SQL basics, advanced queries, database design, and best practices. Includes interactive examples and exercises.'
                         },
                         { 
                             name: 'LeetCode SQL Problems', 
                             type: 'Practice', 
                             platform: 'LeetCode', 
                             hours: 30, 
                             description: 'Practice solving real-world SQL problems with varying difficulty levels. Great for improving query optimization and problem-solving skills.'
                         }
                     ],
                     projects: [
                         {
                             title: 'E-commerce Database Design',
                             description: 'Design a complete database schema for an online store including products, customers, orders, and inventory. Implement complex queries for sales analytics, customer segmentation, and inventory management.'
                         },
                         {
                             title: 'Business Analytics Dashboard',
                             description: 'Create comprehensive SQL queries for business intelligence including sales trends, customer behavior analysis, and performance metrics. Focus on optimization and data visualization integration.'
                         },
                         {
                             title: 'Data Pipeline with SQL and Python',
                             description: 'Build an ETL pipeline that extracts data from multiple sources, transforms it using SQL, and loads it into a data warehouse. Include data quality checks and monitoring.'
                         }
                     ]
                 },
                                 'Machine Learning': {
                     type: 'AI/ML',
                     difficulty: 'Advanced',
                     timeToLearn: '8-12 weeks',
                     resources: [
                         { 
                             name: 'Machine Learning Course', 
                             type: 'Course', 
                             platform: 'Stanford Online', 
                             hours: 80, 
                             description: 'Comprehensive course covering supervised and unsupervised learning, neural networks, and practical applications. Includes mathematical foundations and hands-on projects with real-world datasets.'
                         },
                         { 
                             name: 'Hands-On Machine Learning', 
                             type: 'Book', 
                             platform: 'O\'Reilly', 
                             hours: 100, 
                             description: 'Practical guide to machine learning with scikit-learn, TensorFlow, and Keras. Covers end-to-end ML projects from data preprocessing to model deployment.'
                         },
                         { 
                             name: 'Kaggle Courses', 
                             type: 'Course', 
                             platform: 'Kaggle', 
                             hours: 50, 
                             description: 'Free courses on Python, machine learning, and deep learning. Includes hands-on exercises and access to real datasets for practice.'
                         }
                     ],
                     projects: [
                         {
                             title: 'Customer Churn Prediction Model',
                             description: 'Develop a machine learning model to predict customer churn using historical data. Include feature engineering, model selection, hyperparameter tuning, and deployment considerations. Focus on business impact and interpretability.'
                         },
                         {
                             title: 'Image Classification System',
                             description: 'Build a deep learning model for image classification using CNN architectures. Include data augmentation, transfer learning, and model optimization. Deploy the model as a web service with real-time predictions.'
                         },
                         {
                             title: 'Recommendation Engine',
                             description: 'Create a recommendation system using collaborative filtering and content-based approaches. Implement both user-based and item-based recommendations with evaluation metrics and A/B testing framework.'
                         }
                     ]
                 },
                                 'React': {
                     type: 'Frontend Framework',
                     difficulty: 'Intermediate',
                     timeToLearn: '6-8 weeks',
                     resources: [
                         { 
                             name: 'React Tutorial', 
                             type: 'Course', 
                             platform: 'React Official', 
                             hours: 35, 
                             description: 'Official React documentation and tutorials covering hooks, components, state management, and modern React patterns. Includes interactive examples and best practices.'
                         },
                         { 
                             name: 'Full Stack Open', 
                             type: 'Course', 
                             platform: 'University of Helsinki', 
                             hours: 120, 
                             description: 'Comprehensive full-stack development course covering React, Node.js, databases, and deployment. Includes modern JavaScript, testing, and CI/CD practices.'
                         },
                         { 
                             name: 'React Projects on YouTube', 
                             type: 'Tutorial', 
                             platform: 'YouTube', 
                             hours: 25, 
                             description: 'Free video tutorials covering React fundamentals, advanced concepts, and real-world project building. Great for visual learners and hands-on practice.'
                         }
                     ],
                     projects: [
                         {
                             title: 'Task Management Application',
                             description: 'Build a full-featured task management app with React hooks, local storage, drag-and-drop functionality, and responsive design. Include user authentication, task categories, and progress tracking.'
                         },
                         {
                             title: 'Portfolio Website',
                             description: 'Create a modern, responsive portfolio website using React with smooth animations, contact forms, and project showcases. Include SEO optimization and performance best practices.'
                         },
                         {
                             title: 'Real-time Chat Application',
                             description: 'Develop a real-time chat app using React, WebSocket connections, and a backend API. Include user authentication, message history, file sharing, and online status indicators.'
                         }
                     ]
                 },
                                 'Docker': {
                     type: 'DevOps',
                     difficulty: 'Intermediate',
                     timeToLearn: '3-4 weeks',
                     resources: [
                         { 
                             name: 'Docker for Beginners', 
                             type: 'Course', 
                             platform: 'Docker Official', 
                             hours: 20, 
                             description: 'Official Docker tutorial covering container basics, Dockerfile creation, image management, and container orchestration. Includes hands-on labs and real-world examples.'
                         },
                         { 
                             name: 'Docker Deep Dive', 
                             type: 'Book', 
                             platform: 'Packt', 
                             hours: 40, 
                             description: 'Comprehensive guide to Docker internals, advanced networking, security best practices, and production deployment strategies. Covers Docker Compose and Swarm.'
                         },
                         { 
                             name: 'Docker Tutorial on YouTube', 
                             type: 'Tutorial', 
                             platform: 'YouTube', 
                             hours: 15, 
                             description: 'Free video tutorials covering Docker fundamentals, practical examples, and common use cases. Great for visual learners and quick reference.'
                         }
                     ],
                     projects: [
                         {
                             title: 'Web Application Containerization',
                             description: 'Containerize a full-stack web application with separate containers for frontend, backend, and database. Include Docker Compose for local development and production deployment considerations.'
                         },
                         {
                             title: 'Microservices Architecture',
                             description: 'Design and implement a microservices architecture using Docker containers. Include service discovery, load balancing, and monitoring. Deploy using Docker Swarm or Kubernetes.'
                         },
                         {
                             title: 'CI/CD Pipeline with Docker',
                             description: 'Build a complete CI/CD pipeline using Docker, GitHub Actions, and cloud deployment. Include automated testing, security scanning, and blue-green deployment strategies.'
                         }
                     ]
                 },
                                 'AWS': {
                     type: 'Cloud Platform',
                     difficulty: 'Intermediate',
                     timeToLearn: '6-8 weeks',
                     resources: [
                         { 
                             name: 'AWS Cloud Practitioner', 
                             type: 'Certification', 
                             platform: 'AWS', 
                             hours: 60, 
                             description: 'Foundation-level AWS certification covering cloud concepts, security, architecture, pricing, and support. Includes hands-on labs and practice exams for comprehensive preparation.'
                         },
                         { 
                             name: 'AWS Solutions Architect', 
                             type: 'Course', 
                             platform: 'A Cloud Guru', 
                             hours: 80, 
                             description: 'Comprehensive course preparing for AWS Solutions Architect certification. Covers advanced AWS services, architecture patterns, and real-world deployment scenarios.'
                         },
                         { 
                             name: 'AWS Tutorials', 
                             type: 'Tutorial', 
                             platform: 'AWS Official', 
                             hours: 30, 
                             description: 'Free official AWS tutorials covering core services, best practices, and hands-on projects. Includes step-by-step guides and sample code.'
                         }
                     ],
                     projects: [
                         {
                             title: 'Web Application Deployment on AWS',
                             description: 'Deploy a full-stack web application using AWS services including EC2, RDS, S3, and CloudFront. Implement auto-scaling, load balancing, and monitoring with CloudWatch.'
                         },
                         {
                             title: 'Serverless Architecture',
                             description: 'Build a serverless application using AWS Lambda, API Gateway, DynamoDB, and S3. Include event-driven architecture, authentication, and cost optimization strategies.'
                         },
                         {
                             title: 'Data Pipeline with AWS Services',
                             description: 'Create a data processing pipeline using AWS Glue, S3, Redshift, and QuickSight. Include ETL processes, data warehousing, and business intelligence dashboards.'
                         }
                     ]
                 },
                                 'Data Analysis': {
                     type: 'Analytics',
                     difficulty: 'Intermediate',
                     timeToLearn: '4-6 weeks',
                     resources: [
                         { 
                             name: 'Data Analysis with Python', 
                             type: 'Course', 
                             platform: 'Coursera', 
                             hours: 45, 
                             description: 'Comprehensive course covering pandas, numpy, matplotlib, and seaborn for data manipulation and visualization. Includes statistical analysis and real-world case studies.'
                         },
                         { 
                             name: 'Python for Data Analysis', 
                             type: 'Book', 
                             platform: 'O\'Reilly', 
                             hours: 70, 
                             description: 'In-depth guide to data analysis using Python libraries. Covers data cleaning, transformation, aggregation, and visualization with practical examples.'
                         },
                         { 
                             name: 'DataCamp Data Analysis', 
                             type: 'Course', 
                             platform: 'DataCamp', 
                             hours: 35, 
                             description: 'Interactive course focusing on data analysis workflows, statistical concepts, and visualization techniques. Includes hands-on projects with real datasets.'
                         }
                     ],
                     projects: [
                         {
                             title: 'Real-world Dataset Analysis',
                             description: 'Conduct comprehensive analysis of a real-world dataset (e.g., sales data, customer behavior, or financial data). Include data cleaning, exploratory analysis, statistical testing, and actionable insights.'
                         },
                         {
                             title: 'Interactive Data Visualizations',
                             description: 'Create interactive dashboards using tools like Plotly, Dash, or Tableau. Include multiple chart types, filters, and drill-down capabilities for comprehensive data exploration.'
                         },
                         {
                             title: 'Business Intelligence Dashboard',
                             description: 'Build a complete BI dashboard with automated data pipelines, KPI tracking, and executive reporting. Include data refresh mechanisms, alerting, and mobile-responsive design.'
                         }
                     ]
                 }
            };

            // Generate recommendations for each missing skill
            const skillCards = missingSkills.map(skill => {
                                 const recommendation = skillRecommendations[skill] || {
                     type: 'Technical Skill',
                     difficulty: 'Intermediate',
                     timeToLearn: '4-6 weeks',
                     resources: [
                         { 
                             name: `${skill} Fundamentals`, 
                             type: 'Course', 
                             platform: 'Online Learning', 
                             hours: 30, 
                             description: `Comprehensive course covering ${skill} fundamentals, best practices, and practical applications. Focus on hands-on learning and real-world examples.`
                         },
                         { 
                             name: `${skill} Practice Projects`, 
                             type: 'Practice', 
                             platform: 'Various', 
                             hours: 20, 
                             description: `Practice exercises and mini-projects to reinforce ${skill} concepts. Include coding challenges, real-world scenarios, and portfolio-building activities.`
                         }
                     ],
                     projects: [
                         {
                             title: `Build a ${skill} Project`,
                             description: `Create a practical application using ${skill} that demonstrates your understanding of core concepts. Include proper documentation, testing, and deployment considerations.`
                         },
                         {
                             title: `Portfolio Piece with ${skill}`,
                             description: `Develop a showcase project that highlights your ${skill} expertise. Focus on clean code, best practices, and solving real-world problems effectively.`
                         },
                         {
                             title: `Open-source ${skill} Contribution`,
                             description: `Contribute to an existing open-source project that uses ${skill}. This demonstrates collaboration skills, code review experience, and community involvement.`
                         }
                     ]
                 };

                return `
                    <div class="card" style="margin-bottom: 1.5rem; border-left: 4px solid var(--primary);">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
                            <div>
                                <h3 style="color: var(--text-dark); margin-bottom: 0.5rem;">${skill}</h3>
                                <div style="display: flex; gap: 1rem; font-size: 0.875rem; color: var(--muted);">
                                    <span>${recommendation.type}</span>
                                    <span>•</span>
                                    <span>${recommendation.difficulty}</span>
                                    <span>•</span>
                                    <span>${recommendation.timeToLearn}</span>
                                </div>
                            </div>
                            <span style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.875rem; font-weight: 500;">
                                ${recommendation.timeToLearn}
                            </span>
                        </div>
                        
                                                 <div style="margin-bottom: 1.5rem;">
                             <h4 style="color: var(--text-dark); margin-bottom: 0.75rem; font-size: 1rem;">📚 Learning Resources</h4>
                             <div style="display: grid; gap: 0.75rem;">
                                 ${recommendation.resources.map(resource => `
                                     <div style="padding: 1rem; background: var(--bg); border-radius: var(--radius); border-left: 3px solid var(--success);">
                                         <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                                             <div style="width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1rem; background: rgba(16, 185, 129, 0.2); color: #10b981;">
                                                 <i class="fas fa-graduation-cap"></i>
                                             </div>
                                             <div>
                                                 <div style="font-weight: 600; color: var(--text-dark);">${resource.name}</div>
                                                 <div style="font-size: 0.875rem; color: var(--muted);">
                                                     ${resource.type} • ${resource.platform} • ${resource.hours} hours
                                                 </div>
                                             </div>
                                         </div>
                                         <div style="font-size: 0.875rem; color: var(--text-gray); line-height: 1.5;">
                                             ${resource.description || 'Comprehensive learning resource covering fundamental concepts and practical applications.'}
                                         </div>
                                     </div>
                                 `).join('')}
                             </div>
                         </div>

                                                 <div>
                             <h4 style="color: var(--text-dark); margin-bottom: 0.75rem; font-size: 1rem;">🚀 Project Ideas</h4>
                             <div style="display: grid; gap: 0.75rem;">
                                 ${recommendation.projects.map(project => `
                                     <div style="padding: 1rem; background: var(--bg); border-radius: var(--radius); border-left: 3px solid var(--warning);">
                                         <div style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 0.5rem;">
                                             <div style="width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1rem; background: rgba(245, 158, 11, 0.2); color: #f59e0b; flex-shrink: 0;">
                                                 <i class="fas fa-project-diagram"></i>
                                             </div>
                                             <div style="flex: 1;">
                                                 <div style="font-weight: 600; color: var(--text-dark); margin-bottom: 0.25rem;">${project.title}</div>
                                                 <div style="font-size: 0.875rem; color: var(--text-gray); line-height: 1.5;">
                                                     ${project.description}
                                                 </div>
                                             </div>
                                         </div>
                                     </div>
                                 `).join('')}
                             </div>
                         </div>
                    </div>
                `;
            }).join('');

                         // Generate overall improvement strategy
             const highestScore = Math.max(...matchData.map(m => m.score));
             const improvementNeeded = 1 - highestScore;
             const targetScore = Math.min(0.95, highestScore + 0.15); // Aim for 15% improvement or 95%
             
             // Get specific missing skills for display
             const missingSkillsList = missingSkills.slice(0, 3).map(skill => `<strong>${skill}</strong>`).join(', ');
             const remainingSkills = missingSkills.length > 3 ? ` and ${missingSkills.length - 3} more` : '';

             const overallStrategy = `
                 <div class="card" style="margin-bottom: 2rem; background: linear-gradient(135deg, rgba(14, 165, 233, 0.1), rgba(16, 185, 129, 0.1)); border: 1px solid var(--primary);">
                     <h3 style="color: var(--text-dark); margin-bottom: 1rem;">🎯 Overall Improvement Strategy</h3>
                     <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1rem;">
                         <div>
                             <h4 style="color: var(--text-dark); margin-bottom: 0.5rem; font-size: 1rem;">Current Status</h4>
                             <div style="background: var(--bg); padding: 1rem; border-radius: var(--radius);">
                                 <div style="font-size: 0.875rem; color: var(--muted); margin-bottom: 0.5rem;">Highest Match Score</div>
                                 <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary);">${(highestScore * 100).toFixed(1)}%</div>
                                 <div style="font-size: 0.875rem; color: var(--text-gray); margin-top: 0.25rem;">
                                     ${matchData.length} roles analyzed
                                 </div>
                             </div>
                         </div>
                         <div>
                             <h4 style="color: var(--text-dark); margin-bottom: 0.5rem; font-size: 1rem;">Target Goal</h4>
                             <div style="background: var(--bg); padding: 1rem; border-radius: var(--radius);">
                                 <div style="font-size: 0.875rem; color: var(--muted); margin-bottom: 0.5rem;">Target Match Score</div>
                                 <div style="font-size: 1.5rem; font-weight: 700; color: var(--success);">${(targetScore * 100).toFixed(1)}%</div>
                                 <div style="font-size: 0.875rem; color: var(--text-gray); margin-top: 0.25rem;">
                                     +${((targetScore - highestScore) * 100).toFixed(1)}% improvement needed
                                 </div>
                             </div>
                         </div>
                     </div>
                     <div style="background: var(--bg); padding: 1rem; border-radius: var(--radius); margin-bottom: 1rem;">
                         <h4 style="color: var(--text-dark); margin-bottom: 0.5rem; font-size: 1rem;">🎯 Missing Skills Identified</h4>
                         <div style="color: var(--text-gray); line-height: 1.6;">
                             <p style="margin-bottom: 0.5rem;">Based on your analysis, you need to develop: <span style="color: var(--text-dark);">${missingSkillsList}${remainingSkills}</span></p>
                             <p style="font-size: 0.875rem; color: var(--muted);">These skills were identified as gaps across ${matchData.length} job matches.</p>
                         </div>
                     </div>
                     <div style="background: var(--bg); padding: 1rem; border-radius: var(--radius);">
                         <h4 style="color: var(--text-dark); margin-bottom: 0.5rem; font-size: 1rem;">📈 Action Plan</h4>
                         <ul style="color: var(--text-gray); line-height: 1.6; padding-left: 1.5rem;">
                             <li>Focus on the <strong>${missingSkills.length}</strong> missing skills identified above</li>
                             <li>Complete <strong>${Math.ceil(missingSkills.length * 0.7)}</strong> recommended courses (see detailed recommendations below)</li>
                             <li>Build <strong>${Math.ceil(missingSkills.length * 0.5)}</strong> portfolio projects (specific project ideas provided for each skill)</li>
                             <li>Target completion: <strong>${Math.ceil(missingSkills.length * 6)} weeks</strong></li>
                         </ul>
                     </div>
                 </div>
             `;

            return overallStrategy + skillCards;
        }

        // Tab switching function
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.style.background = 'transparent';
                btn.style.color = 'var(--muted)';
            });

            // Show selected tab
            document.getElementById(`${tabName}-tab`).style.display = 'block';
            event.target.classList.add('active');
            event.target.style.background = 'var(--primary)';
            event.target.style.color = 'white';
        }

        // Get score class for styling
        function getScoreClass(score) {
            if (score >= 0.8) return 'score-excellent';
            if (score >= 0.6) return 'score-good';
            if (score >= 0.4) return 'score-fair';
            return 'score-poor';
        }

        // Get score icon
        function getScoreIcon(score) {
            if (score >= 0.8) return 'fas fa-star';
            if (score >= 0.6) return 'fas fa-thumbs-up';
            if (score >= 0.4) return 'fas fa-meh';
            return 'fas fa-thumbs-down';
        }

        // Render results table
        function renderResults(roles) {
            const resultsSection = document.getElementById('results');
            const emptyState = document.getElementById('empty-state');
            const resultsBody = document.getElementById('results-body');
            const resultsCount = document.getElementById('results-count');

            if (!roles.length) {
                resultsSection.style.display = 'none';
                emptyState.style.display = 'block';
                emptyState.innerHTML = `
                    <i class="fas fa-search-minus empty-icon"></i>
                    <h3>No matches found</h3>
                    <p>Try updating your resume text with more skills and experience details.</p>
                `;
                return;
            }

            // Show enhanced tabs only (basic results table is now in Job Matches tab)
            document.getElementById('enhanced-tabs').style.display = 'block';
            document.getElementById('basic-results').style.display = 'none';
            
            emptyState.style.display = 'none';
            resultsSection.style.display = 'block';
            resultsSection.classList.add('fade-in');
            resultsCount.textContent = `${roles.length} result${roles.length !== 1 ? 's' : ''}`;

                         resultsBody.innerHTML = roles.map(role => `
                 <tr data-enhanced-reasons='${JSON.stringify(role.enhanced_reasons || [])}'>
                     <td>
                         <div class="role-title">${role.title}</div>
                         <div class="role-id">${role.id}</div>
                     </td>
                     <td>
                         <div class="score ${getScoreClass(role.score)}">
                             <i class="${getScoreIcon(role.score)}"></i>
                             ${(role.score * 100).toFixed(1)}%
                         </div>
                     </td>
                     <td>
                         <div class="skills">
                             ${role.matched_skills.map(skill => `
                                 <span class="skill-tag skill-matched">${skill}</span>
                             `).join('')}
                         </div>
                     </td>
                     <td>
                         <div class="skills">
                             ${role.missing_skills.map(skill => `
                                 <span class="skill-tag skill-missing">${skill}</span>
                             `).join('')}
                         </div>
                     </td>
                 </tr>
             `).join('');
        }

        // Tab switching function
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.style.background = 'transparent';
                btn.style.color = 'var(--muted)';
            });

            // Show selected tab
            document.getElementById(`${tabName}-tab`).style.display = 'block';
            event.target.classList.add('active');
            event.target.style.background = 'var(--primary)';
            event.target.style.color = 'white';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Employee Suggester initialized');
        });

        // Helper functions for new design
        function fillSample(){
            const t = `SKILLS: Python, SQL, React, Docker, Linux
EXPERIENCE: Built REST APIs and ETL jobs; created dashboards; collaborated with product.
PROJECTS: Churn analysis, Next.js dashboard, Airflow pipelines`;
            document.getElementById('resume').value = t;
        }

        function downloadSkills(){ 
            const link = document.createElement('a');
            link.href = '../data/taxonomy/skills.csv';
            link.download = 'skills.csv';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        function downloadJobs(){ 
            const link = document.createElement('a');
            link.href = '../data/jobs/jobs.jsonl';
            link.download = 'jobs.jsonl';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Global variable to store selected role
        let selectedRole = 'auto';

        // Role selection function
        function selectRole(role) {
            selectedRole = role;
            
            // Update visual selection
            document.querySelectorAll('.role-option').forEach(option => {
                option.style.border = '2px solid var(--border)';
                option.style.background = 'var(--bg-light)';
                option.style.color = 'var(--text)';
            });
            
            const selectedElement = document.getElementById(`role-${role}`);
            if (selectedElement) {
                selectedElement.style.border = '2px solid var(--primary)';
                selectedElement.style.background = 'var(--primary)';
                selectedElement.style.color = 'white';
            }
            
            // Show notification
            const roleName = role === 'auto' ? 'Auto-Detect' : role;
            showNotification(`Target role set to: ${roleName}`, 'success');
            
            console.log(`🎯 Role selected: ${role}`);
        }

        // Populate role dropdown with job matches
        function populateRoleDropdown(jobMatches) {
            const roleSelect = document.getElementById('target-role-select');
            const roleSelectionSection = document.getElementById('role-selection-section');
            
            if (!roleSelect || !roleSelectionSection) {
                console.warn('Role selection elements not found');
                return;
            }
            
            // Clear existing options
            roleSelect.innerHTML = '';
            
            if (!jobMatches || jobMatches.length === 0) {
                roleSelect.innerHTML = '<option value="">No job matches available</option>';
                roleSelectionSection.style.display = 'none';
                return;
            }
            
            // Add default option
            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.textContent = '-- Select a target role --';
            roleSelect.appendChild(defaultOption);
            
            // Add job match roles
            jobMatches.forEach((match, index) => {
                const option = document.createElement('option');
                option.value = match.title;
                option.textContent = `${match.title} (${(match.score * 100).toFixed(1)}% match)`;
                roleSelect.appendChild(option);
            });
            
            // Show the role selection section
            roleSelectionSection.style.display = 'block';
            
            console.log(`🎯 Populated role dropdown with ${jobMatches.length} roles`);
        }

        // Generate upskilling for selected role
        async function generateUpskillingForSelectedRole() {
            const roleSelect = document.getElementById('target-role-select');
            const selectedRole = roleSelect.value;
            
            if (!selectedRole) {
                showNotification('Please select a target role first', 'error');
                return;
            }
            
            const button = document.getElementById('generate-upskilling-btn');
            setButtonLoading(button, true);
            
            try {
                console.log(`🎯 Generating upskilling for selected role: ${selectedRole}`);
                
                // Get resume skills from the original resume data or table
                let resumeSkills = getResumeSkillsFromTable();
                
                // If no skills found in table, try to get from original resume data
                if (!resumeSkills || resumeSkills.length === 0) {
                    console.log('🔍 No skills found in table, trying to get from original resume data...');
                    resumeSkills = window.originalResumeSkills || ['python', 'sql', 'react', 'docker']; // Fallback
                }
                
                console.log('🔍 Debug: Resume skills for role-specific upskilling:', resumeSkills);
                
                // Get default missing skills for the selected role
                const defaultMissingSkills = getDefaultSkillsForRole(selectedRole);
                
                console.log('🔍 Debug: Default missing skills for role:', defaultMissingSkills);
                
                // Call the enhanced upskilling API with target role
                const response = await fetch(`${API}/upskill/enhanced`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        resume_skills: resumeSkills,
                        job_matches: [{
                            title: selectedRole,
                            score: 0.771, // Default score for role-specific upskilling
                            missing_skills: defaultMissingSkills // Use default skills for the role
                        }],
                        target_role: selectedRole
                    })
                });

                if (!response.ok) {
                    throw new Error(`Enhanced upskilling API failed: ${response.status}`);
                }

                const upskillingResult = await response.json();
                console.log('🔍 Debug: Role-specific upskilling result:', upskillingResult);
                
                // Check if we got meaningful data
                const prioritySkills = upskillingResult.priority_skills || [];
                const skillRecommendations = upskillingResult.skill_recommendations || [];
                
                console.log('🔍 Debug: Priority skills count:', prioritySkills.length);
                console.log('🔍 Debug: Skill recommendations count:', skillRecommendations.length);
                
                if (prioritySkills.length === 0 && skillRecommendations.length === 0) {
                    throw new Error('No upskilling recommendations generated for this role');
                }
                
                // Display the upskilling content
                const upskillingContent = generateEnhancedUpskillingContent(upskillingResult);
                document.getElementById('upskill-content').innerHTML = upskillingContent;
                
                showNotification(`Upskilling plan generated for ${selectedRole}!`, 'success');
                
            } catch (error) {
                console.error('Error generating upskilling for selected role:', error);
                showNotification(`Failed to generate upskilling plan: ${error.message}. Please try again.`, 'error');
            } finally {
                setButtonLoading(button, false);
            }
        }

        // Get job matches from the results table
        function getJobMatchesFromTable() {
            const resultsBody = document.getElementById('results-body');
            const rows = resultsBody.querySelectorAll('tr');
            const jobMatches = [];
            
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length >= 4) {
                    const roleTitle = cells[0].querySelector('.role-title')?.textContent || 'Unknown Role';
                    const scoreText = cells[1].querySelector('.score')?.textContent || '0%';
                    const score = parseFloat(scoreText.replace('%', '')) / 100;
                    const missingSkills = Array.from(cells[3].querySelectorAll('.skill-tag')).map(tag => tag.textContent);
                    
                    jobMatches.push({
                        title: roleTitle,
                        score: score,
                        missing_skills: missingSkills
                    });
                }
            });
            
            return jobMatches;
        }

        // Get resume skills from the results table
        function getResumeSkillsFromTable() {
            const resultsBody = document.getElementById('results-body');
            const rows = resultsBody.querySelectorAll('tr');
            const resumeSkills = new Set();
            
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length >= 4) {
                    const matchedSkills = Array.from(cells[2].querySelectorAll('.skill-tag')).map(tag => tag.textContent);
                    matchedSkills.forEach(skill => resumeSkills.add(skill.toLowerCase()));
                }
            });
            
            return Array.from(resumeSkills);
        }

        // Get role-specific upskilling recommendations
        async function getRoleSpecificUpskilling(resumeSkills, jobMatches, targetRole) {
            try {
                console.log(`🎯 Getting upskilling for role: ${targetRole}`);
                
                // Call the enhanced upskilling API with role-specific data
                const response = await fetch(`${API}/upskill/enhanced`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        resume_skills: resumeSkills,
                        job_matches: jobMatches,
                        target_role: targetRole
                    })
                });

                if (!response.ok) {
                    throw new Error(`Upskilling API failed: ${response.status}`);
                }

                const result = await response.json();
                console.log(`✅ Role-specific upskilling result:`, result);
                return result;
                
            } catch (error) {
                console.error('❌ Role-specific upskilling failed:', error);
                throw error;
            }
        }
    </script>

    <footer class="site-footer" id="footer">
        <div class="container footer-grid">
            <div>
                <div class="brand"><img src="../images/logo/TN LOGO.png" alt="Employee Suggester Logo" class="logo-img"> Employee Suggester</div>
                <p class="muted">Open-source MVP that suggests roles from a resume and highlights missing skills.</p>
                <div class="tiny">© <span id="year"></span> Employee Suggester. All rights reserved.</div>
                <div class="tiny" style="margin-top: 0.5rem;">
                    <strong>Version 1.3.0.0</strong> | Developed by <strong>Thiha Naing</strong>
                </div>
            </div>

            <nav aria-label="Quick links">
                <h4>Quick links</h4>
                <ul>
                    <li><a href="#main">Try the demo</a></li>
                    <li><a href="#how">How it works</a></li>
                    <li><a href="#features">Features</a></li>
                    <li><a href="#dataset">Jobs & skills taxonomy</a></li>
                    <li><a href="#api">API reference</a></li>
                </ul>
            </nav>

            <nav aria-label="Resources">
                <h4>Resources</h4>
                <ul>
                    <li><a href="http://127.0.0.1:8001/docs" target="_blank" rel="noopener">FastAPI docs</a></li>
                    <li><a href="https://github.com/your/repo" target="_blank" rel="noopener">GitHub</a></li>
                    <li><a href="../data/taxonomy/skills.csv" download="skills.csv">Download skills.csv</a></li>
                    <li><a href="../data/jobs/jobs.jsonl" download="jobs.jsonl">Download jobs.jsonl</a></li>
                </ul>
            </nav>

            <nav aria-label="Contact">
                <h4>Contact Developer</h4>
                <ul>
                    <li><a href="tel:+60187799581">📞 +60 18-779 9581</a></li>
                    <li><a href="mailto:thiha.naing.codev@gmail.com">📧 thiha.naing.codev@gmail.com</a></li>
                    <li><strong>Developer:</strong> Thiha Naing</li>
                    <li><strong>Version:</strong> 1.3.0.0</li>
                </ul>
            </nav>
        </div>
    </footer>

    <script>
        document.getElementById('year').textContent = new Date().getFullYear();
    </script>
</body>
</html>
